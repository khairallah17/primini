(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3772],{7597:function(e,t,s){Promise.resolve().then(s.bind(s,7872))},6847:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var a=s(7437),l=s(6648),r=s(7138),i=s(2265),n=s(8618);function o(e){var t,s;let{product:o}=e,{addFavorite:c,removeFavorite:d,isFavorite:u}=(0,n.r)(),m=u(o.id),[p,x]=(0,i.useState)(!1),[f,h]=(0,i.useState)(null),g=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/media/")||e.startsWith("media/")){let t="http://azyo6271.odns.fr/".replace("/api",""),s=e.startsWith("/")?e:"/".concat(e);return"".concat(t).concat(s)}if(!e.startsWith("/")){let t="http://azyo6271.odns.fr/".replace("/api","");return"".concat(t,"/media/products/").concat(e)}return e},b=(0,i.useMemo)(()=>o.image_display?o.image_display:o.image_file?g(o.image_file):o.image?g(o.image):null,[o.image_display,o.image_file,o.image]),v=(null===(t=o.tags)||void 0===t?void 0:t.slice(0,3))||[],w=null!==(s=o.lowestPrice)&&void 0!==s?s:o.lowest_price,N=null!=w?"string"==typeof w?parseFloat(w):w:null,j=f||b;return(0,a.jsx)(r.default,{href:"/product/".concat(o.slug),className:"block h-full",children:(0,a.jsxs)("article",{className:"flex h-full flex-col justify-between rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[j&&!p?(0,a.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden rounded-2xl bg-white",children:[v.length>0&&(0,a.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:v.map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,a.jsx)("div",{className:"absolute inset-2 sm:inset-3",children:(0,a.jsx)(l.default,{src:j,alt:o.name,fill:!0,className:"object-contain transition-transform duration-300 hover:scale-105",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw",quality:90,priority:!1,loading:"lazy",placeholder:"blur",blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mN8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",onError:()=>{let e=f===o.image_display||!f&&b===o.image_display,t=f===g(o.image_file)||!f&&b===g(o.image_file);if(e&&o.image_file){let e=g(o.image_file);if(e&&e!==f){h(e),x(!1);return}}if((e||t)&&o.image){let e=g(o.image);if(e&&e!==f&&e!==b){h(e),x(!1);return}}x(!0)}})})]}):(0,a.jsxs)("div",{className:"relative aspect-[4/3] flex items-center justify-center rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200",children:[v.length>0&&(0,a.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:v.map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,a.jsx)("span",{className:"text-xs font-medium text-slate-400",children:"Aucune image"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:o.name}),o.description&&(0,a.jsx)("p",{className:"mt-2 line-clamp-3 text-xs text-slate-500",children:o.description.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/`/g,"").trim()})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[null===N||isNaN(N)?(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Prix en attente"}):(0,a.jsxs)("p",{className:"text-sm font-semibold text-primary",children:[N.toFixed(3)," MAD"]}),(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),m?d(o.id):c(o)},className:"rounded-full px-3 py-2 text-xs font-semibold ".concat(m?"bg-secondary text-white":"bg-slate-200 text-slate-700"),type:"button",children:m?"Retirer":"Favori"})]})]})})}},7872:function(e,t,s){"use strict";s.d(t,{default:function(){return n}});var a=s(7437),l=s(2265),r=s(6847),i=s(9988);function n(){let[e,t]=(0,l.useState)([]),[s,n]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{(async function(){try{let e=await i.Z.get("/products/",{params:{ordering:"-lowest_price",page_size:12}});t(e.data.results.map(e=>{var t;return{...e,lowestPrice:null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price}}))}catch(e){console.warn("Failed to load deals",e)}finally{n(!1)}})()},[]),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"space-y-2",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-slate-900",children:"Bons plans du moment"}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"S\xe9lection quotidienne des meilleures promotions d\xe9nich\xe9es chez nos marchands partenaires."})]}),s?(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,a.jsx)("div",{className:"h-60 animate-pulse rounded-3xl bg-gradient-to-br from-slate-100 to-slate-200"},t))}):e.length>0?(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,a.jsx)(r.Z,{product:e},e.id))}):(0,a.jsx)("p",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center text-sm text-slate-500",children:"Les bons plans reviendront bient\xf4t. Revenez plus tard !"})]})}},8618:function(e,t,s){"use strict";s.d(t,{c:function(){return n},r:function(){return o}});var a=s(7437),l=s(2265);let r=(0,l.createContext)(void 0),i="primini_favorites";function n(e){let{children:t}=e,[s,n]=(0,l.useState)([]);(0,l.useEffect)(()=>{try{let e=window.localStorage.getItem(i);e&&n(JSON.parse(e))}catch(e){console.warn("Failed to restore favorites",e)}},[]),(0,l.useEffect)(()=>{window.localStorage.setItem(i,JSON.stringify(s))},[s]);let o=(0,l.useCallback)(e=>{n(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),c=(0,l.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[]),d=(0,l.useCallback)(e=>s.some(t=>t.id===e),[s]),u=(0,l.useMemo)(()=>({favorites:s,addFavorite:o,removeFavorite:c,isFavorite:d}),[o,s,d,c]);return(0,a.jsx)(r.Provider,{value:u,children:t})}function o(){let e=(0,l.useContext)(r);if(!e)throw Error("useFavorites must be used within FavoritesProvider");return e}},9988:function(e,t,s){"use strict";let a=s(8472).Z.create({baseURL:"http://azyo6271.odns.fr/",withCredentials:!1});t.Z=a}},function(e){e.O(0,[8472,231,4974,2971,7023,1744],function(){return e(e.s=7597)}),_N_E=e.O()}]);