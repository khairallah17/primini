(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3374],{4703:function(e,t,s){Promise.resolve().then(s.bind(s,6006)),Promise.resolve().then(s.bind(s,912)),Promise.resolve().then(s.bind(s,1481))},6847:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var r=s(7437),a=s(6648),i=s(7138),n=s(2265),l=s(8618);function o(e){var t,s;let{product:o}=e,{addFavorite:d,removeFavorite:c,isFavorite:u}=(0,l.r)(),m=u(o.id),[p,f]=(0,n.useState)(!1),[x,h]=(0,n.useState)(null),g=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/media/")||e.startsWith("media/")){let t="http://azyo6271.odns.fr/".replace("/api",""),s=e.startsWith("/")?e:"/".concat(e);return"".concat(t).concat(s)}if(!e.startsWith("/")){let t="http://azyo6271.odns.fr/".replace("/api","");return"".concat(t,"/media/products/").concat(e)}return e},b=(0,n.useMemo)(()=>o.image_display?o.image_display:o.image_file?g(o.image_file):o.image?g(o.image):null,[o.image_display,o.image_file,o.image]),v=(null===(t=o.tags)||void 0===t?void 0:t.slice(0,3))||[],w=null!==(s=o.lowestPrice)&&void 0!==s?s:o.lowest_price,_=null!=w?"string"==typeof w?parseFloat(w):w:null,y=x||b;return(0,r.jsx)(i.default,{href:"/product/".concat(o.slug),className:"block h-full",children:(0,r.jsxs)("article",{className:"flex h-full flex-col justify-between rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[y&&!p?(0,r.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden rounded-2xl bg-white",children:[v.length>0&&(0,r.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:v.map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,r.jsx)("div",{className:"absolute inset-2 sm:inset-3",children:(0,r.jsx)(a.default,{src:y,alt:o.name,fill:!0,className:"object-contain transition-transform duration-300 hover:scale-105",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw",quality:90,priority:!1,loading:"lazy",placeholder:"blur",blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mN8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",onError:()=>{let e=x===o.image_display||!x&&b===o.image_display,t=x===g(o.image_file)||!x&&b===g(o.image_file);if(e&&o.image_file){let e=g(o.image_file);if(e&&e!==x){h(e),f(!1);return}}if((e||t)&&o.image){let e=g(o.image);if(e&&e!==x&&e!==b){h(e),f(!1);return}}f(!0)}})})]}):(0,r.jsxs)("div",{className:"relative aspect-[4/3] flex items-center justify-center rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200",children:[v.length>0&&(0,r.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:v.map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,r.jsx)("span",{className:"text-xs font-medium text-slate-400",children:"Aucune image"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:o.name}),o.description&&(0,r.jsx)("p",{className:"mt-2 line-clamp-3 text-xs text-slate-500",children:o.description.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/`/g,"").trim()})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[null===_||isNaN(_)?(0,r.jsx)("p",{className:"text-sm text-slate-500",children:"Prix en attente"}):(0,r.jsxs)("p",{className:"text-sm font-semibold text-primary",children:[_.toFixed(3)," MAD"]}),(0,r.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),m?c(o.id):d(o)},className:"rounded-full px-3 py-2 text-xs font-semibold ".concat(m?"bg-secondary text-white":"bg-slate-200 text-slate-700"),type:"button",children:m?"Retirer":"Favori"})]})]})})}},6006:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(7437),a=s(2265),i=s(9343),n=s(1014),l=s(9988),o=s(6453),d=s(6847);function c(){let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(),{register:p,handleSubmit:f,formState:{errors:x,isSubmitting:h},reset:g}=(0,i.cI)({resolver:(0,n.F)(o.xj)}),b=async e=>{c(!0),m(void 0);try{var s;let r=await l.Z.post("/products/magic_lookup/",{link:e.url});t((null!==(s=r.data.products)&&void 0!==s?s:[]).map(e=>{var t;return{...e,lowestPrice:null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price}})),m(r.data.message),g()}catch(e){console.warn("Failed to analyse url",e),m("Impossible de r\xe9cup\xe9rer les informations pour ce lien.")}finally{c(!1)}};return(0,r.jsxs)("div",{className:"space-y-10",children:[(0,r.jsxs)("header",{className:"space-y-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold text-slate-900",children:"L'outil magique"}),(0,r.jsx)("p",{className:"text-sm text-slate-500",children:"Collez un lien produit pour d\xe9couvrir automatiquement les meilleures offres disponibles."})]}),(0,r.jsxs)("form",{onSubmit:f(b),className:"flex flex-col gap-3 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm md:flex-row",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("input",{type:"url",...p("url"),placeholder:"https://www.example.com/produit",className:"w-full rounded-2xl border border-slate-200 px-4 py-3 text-sm ".concat(x.url?"border-red-500":"")}),x.url&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.url.message})]}),(0,r.jsx)("button",{type:"submit",className:"rounded-full bg-primary px-5 py-3 text-sm font-semibold text-white disabled:opacity-60",disabled:h||s,children:s?"Analyse en cours...":"Comparer"})]}),u&&(0,r.jsx)("p",{className:"rounded-2xl bg-slate-100 px-4 py-3 text-sm text-slate-600",children:u}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,r.jsx)(d.Z,{product:e},e.id))})]})}},8618:function(e,t,s){"use strict";s.d(t,{c:function(){return l},r:function(){return o}});var r=s(7437),a=s(2265);let i=(0,a.createContext)(void 0),n="primini_favorites";function l(e){let{children:t}=e,[s,l]=(0,a.useState)([]);(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem(n);e&&l(JSON.parse(e))}catch(e){console.warn("Failed to restore favorites",e)}},[]),(0,a.useEffect)(()=>{window.localStorage.setItem(n,JSON.stringify(s))},[s]);let o=(0,a.useCallback)(e=>{l(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),d=(0,a.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),c=(0,a.useCallback)(e=>s.some(t=>t.id===e),[s]),u=(0,a.useMemo)(()=>({favorites:s,addFavorite:o,removeFavorite:d,isFavorite:c}),[o,s,c,d]);return(0,r.jsx)(i.Provider,{value:u,children:t})}function o(){let e=(0,a.useContext)(i);if(!e)throw Error("useFavorites must be used within FavoritesProvider");return e}},9988:function(e,t,s){"use strict";let r=s(8472).Z.create({baseURL:"http://azyo6271.odns.fr/",withCredentials:!1});t.Z=r},6453:function(e,t,s){"use strict";s.d(t,{$T:function(){return o},Iy:function(){return a},cU:function(){return l},dm:function(){return i},xj:function(){return d}});var r=s(546);let a=r.Ryn({name:r.Z_8().min(1,"Le nom du produit est requis").min(3,"Le nom doit contenir au moins 3 caract\xe8res").max(200,"Le nom ne peut pas d\xe9passer 200 caract\xe8res"),description:r.Z_8().min(1,"La description est requise").min(500,"La description doit contenir au moins 500 caract\xe8res").max(5e3,"La description ne peut pas d\xe9passer 5000 caract\xe8res"),brand:r.Z_8().max(120,"La marque ne peut pas d\xe9passer 120 caract\xe8res").optional().or(r.i0J("")),category_id:r.G0j([r.Rxh().positive("Cat\xe9gorie invalide"),r.qnd(),r.S1Z()]).transform(e=>"number"!=typeof e||isNaN(e)?void 0:e).optional(),image:r.Z_8().refine(e=>!e||r.Z_8().url().safeParse(e).success,"URL invalide").optional().or(r.i0J("")),tags:r.IXX(r.Z_8().min(1,"Les tags ne peuvent pas \xeatre vides")).max(20,"Maximum 20 tags autoris\xe9s").optional(),specs:r.IMB(r.Z_8(),r.G0j([r.Z_8(),r.Rxh(),r.O72()])).optional(),release_date:r.Z_8().refine(e=>!e||/^\d{4}-\d{2}-\d{2}$/.test(e),"Format de date invalide (YYYY-MM-DD)").optional().or(r.i0J("")),source_category:r.Z_8().max(150,"La cat\xe9gorie source ne peut pas d\xe9passer 150 caract\xe8res").optional().or(r.i0J(""))}),i=r.Ryn({email:r.Z_8().min(1,"L'adresse email est requise").email("Format d'email invalide"),password:r.Z_8().min(1,"Le mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caract\xe8res")}),n=r.Ryn({username:r.Z_8().min(1,"Le nom d'utilisateur est requis").min(3,"Le nom d'utilisateur doit contenir au moins 3 caract\xe8res").max(150,"Le nom d'utilisateur ne peut pas d\xe9passer 150 caract\xe8res").regex(/^[a-zA-Z0-9_]+$/,"Le nom d'utilisateur ne peut contenir que des lettres, chiffres et underscores"),email:r.Z_8().min(1,"L'adresse email est requise").email("Format d'email invalide"),password1:r.Z_8().min(1,"Le mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caract\xe8res").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Le mot de passe doit contenir au moins une majuscule, une minuscule et un chiffre"),password2:r.Z_8().min(1,"La confirmation du mot de passe est requise"),first_name:r.Z_8().min(1,"Le pr\xe9nom est requis").max(150,"Le pr\xe9nom ne peut pas d\xe9passer 150 caract\xe8res"),last_name:r.Z_8().min(1,"Le nom est requis").max(150,"Le nom ne peut pas d\xe9passer 150 caract\xe8res")}),l=n.extend({enterprise_name:r.Z_8().min(1,"Le nom de l'entreprise est requis").max(200,"Le nom de l'entreprise ne peut pas d\xe9passer 200 caract\xe8res"),address:r.Z_8().min(1,"L'adresse est requise").max(500,"L'adresse ne peut pas d\xe9passer 500 caract\xe8res"),phone_number:r.Z_8().min(1,"Le num\xe9ro de t\xe9l\xe9phone est requis").max(20,"Le num\xe9ro de t\xe9l\xe9phone ne peut pas d\xe9passer 20 caract\xe8res").regex(/^[\d\s\-\+\(\)]+$/,"Le num\xe9ro de t\xe9l\xe9phone contient des caract\xe8res invalides")}).refine(e=>e.password1===e.password2,{message:"Les mots de passe ne correspondent pas",path:["password2"]}),o=n.refine(e=>e.password1===e.password2,{message:"Les mots de passe ne correspondent pas",path:["password2"]});r.Ryn({threshold:r.Z_8().min(1,"Le prix seuil est requis").refine(e=>!isNaN(Number(e))&&Number(e)>0,"Le prix doit \xeatre un nombre positif")});let d=r.Ryn({url:r.Z_8().min(1,"L'URL est requise").url("Format d'URL invalide")});r.Ryn({file:r.PpW(File).refine(e=>e.size<=10485760,"Le fichier ne peut pas d\xe9passer 10MB").refine(e=>e.name.endsWith(".csv"),"Le fichier doit \xeatre un fichier CSV")})},912:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=s(5592);function a(e){let{reason:t,children:s}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return s}},1481:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return i}});let r=s(7437),a=s(8512);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let s=(0,a.getExpectedRequestStore)("next/dynamic css"),i=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:s.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[8472,231,4974,5981,2971,7023,1744],function(){return e(e.s=4703)}),_N_E=e.O()}]);