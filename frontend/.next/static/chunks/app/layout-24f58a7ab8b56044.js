(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{5322:function(e,t,r){Promise.resolve().then(r.bind(r,9082)),Promise.resolve().then(r.bind(r,2813)),Promise.resolve().then(r.bind(r,1390))},9082:function(e,t,r){"use strict";r.d(t,{default:function(){return o}});var s=r(7437),a=r(3429),n=r(8618);function o(e){let{children:t}=e;return(0,s.jsx)(a.H,{children:(0,s.jsx)(n.c,{children:t})})}},2813:function(e,t,r){"use strict";r.d(t,{default:function(){return y}});var s=r(7437),a=r(6463),n=r(3429),o=r(7138),l=r(6648),i=r(2265),c=r(8618),d=r(4573);let u=i.forwardRef(function(e,t){let{title:r,titleId:s,...a}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},a),r?i.createElement("title",{id:s},r):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))});var h=r(1279);let m={categories:[{name:"Informatique",subcategories:["Composants","Ordinateurs","R\xe9seaux et connectivit\xe9","P\xe9riph\xe9riques","Stockages","Tablettes"]},{name:"T\xe9l\xe9phonie",subcategories:["Smartphones","Accessoires T\xe9l\xe9phones","T\xe9l\xe9phones Fixes","Smart Watches"]},{name:"Sant\xe9 - Beaut\xe9",subcategories:["Visage","Cheveux","Corps","Parfums","Dents","Maquillage","Parfum d'ambiance","Sant\xe9","Hommes"]},{name:"Electrom\xe9nager",subcategories:["Aspirateurs","Machine \xe0 Laver","S\xe8che Linges","Lave vaisselles","Fours","Micro Ondes","Plaques de cuisson","Cuisini\xe8res","Hottes aspirantes","Climatiseurs","Chauffages","Chauffe Bain","R\xe9frig\xe9rateurs et cong\xe9lateurs"]},{name:"Petit Electrom\xe9nager",subcategories:["Machines \xe0 caf\xe9","Fer \xe0 Repasser","Blenders","Appareils de cuisson","Robot P\xe9trin et Robot de Cuisine Multifonction","Machine \xe0 Pain","Mixeurs","Batteurs","Moulins \xe0 caf\xe9","Grille Pains","Gaufriers","Balances de cuisine","Bouilloires","Friteuses","Yaourti\xe8re","D\xe9froisseurs \xe0 vapeur","Sorbeti\xe8res","Centrifugeuses"]},{name:"Image & Son",subcategories:["\xc9couteurs","Haut-parleurs","Syst\xe8mes home cin\xe9ma","Microphones","T\xe9l\xe9viseurs","Projecteurs","Digital TV Boxes","TV Accessories","Casques"]},{name:"Photo & Cam\xe9ra",subcategories:["Appareils photos num\xe9riques","Objectifs pour appareil photo"]}]};function x(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}function f(e){var t;let{isOpen:r,onOpenChange:a,children:n}=e,[l,c]=(0,i.useState)(0),[u,h]=(0,i.useState)(null),[f,g]=(0,i.useState)(!1),p=(0,i.useRef)(null),v=(0,i.useRef)(null),b=(0,i.useRef)(null);(0,i.useEffect)(()=>{if(r&&p.current){let e=document.querySelector("header");e&&c(e.getBoundingClientRect().bottom)}},[r]),(0,i.useEffect)(()=>{let e=()=>{g(window.innerWidth<1024)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{if(!r)return;let e=()=>{let e=document.querySelector("header");e&&c(e.getBoundingClientRect().bottom)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[r]),(0,i.useEffect)(()=>()=>{b.current&&clearTimeout(b.current)},[]);let w=()=>{b.current&&(clearTimeout(b.current),b.current=null)},y=()=>{w(),b.current=setTimeout(()=>{a(!1),h(null),b.current=null},300)};return r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{ref:p,onMouseEnter:()=>{w(),a(!0)},onMouseLeave:e=>{let t=e.relatedTarget;if(v.current&&v.current.contains(t)){w();return}y()},className:"relative",children:n}),(0,s.jsx)("div",{ref:v,className:"fixed left-0 right-0 z-50 bg-white shadow-2xl",style:{top:"".concat(l,"px")},onMouseEnter:()=>{w(),a(!0)},onMouseLeave:()=>{y()},children:(0,s.jsx)("div",{className:"bg-white",children:(0,s.jsxs)("div",{className:"mx-auto max-w-7xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 sm:px-6 lg:px-8 py-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-primary",children:"Toutes les cat\xe9gories"}),(0,s.jsx)("button",{onClick:()=>a(!1),className:"rounded-full p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition-colors","aria-label":"Fermer",children:(0,s.jsx)(d.Z,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,s.jsx)("div",{className:"w-full lg:w-1/3 border-b lg:border-b-0 lg:border-r border-gray-200 bg-gray-50",children:(0,s.jsx)("nav",{className:"py-2 lg:py-4 max-h-[400px] lg:max-h-none overflow-y-auto lg:overflow-visible",children:m.categories.map(e=>(0,s.jsx)("div",{onMouseEnter:()=>h(e.name),onClick:()=>{f&&h(u===e.name?null:e.name)},className:"px-4 sm:px-6 py-3 cursor-pointer transition-colors ".concat(u===e.name?"bg-white lg:border-r-2 border-primary text-primary font-semibold":"text-gray-700 hover:bg-white hover:text-primary"),children:(0,s.jsx)(o.default,{href:"/categories/".concat(x(e.name)),onClick:t=>{f&&u===e.name?t.preventDefault():a(!1)},className:"block text-sm sm:text-base",children:e.name})},e.name))})}),(0,s.jsx)("div",{className:"w-full lg:w-2/3 bg-white min-h-[300px] lg:min-h-0",children:u?(0,s.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg lg:text-xl font-bold text-primary mb-4 sm:mb-6",children:u}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 lg:gap-6",children:null===(t=m.categories.find(e=>e.name===u))||void 0===t?void 0:t.subcategories.map((e,t)=>(0,s.jsx)(o.default,{href:"/categories/".concat(x(e)),onClick:()=>a(!1),className:"block px-3 sm:px-4 py-2 text-xs sm:text-sm lg:text-base text-gray-700 hover:text-primary hover:bg-gray-50 rounded-lg transition-all duration-200",children:e},"".concat(u,"-").concat(e,"-").concat(t)))})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full p-8",children:(0,s.jsx)("p",{className:"text-gray-400 text-sm sm:text-base text-center",children:f?"Cliquez sur une cat\xe9gorie pour voir les sous-cat\xe9gories":"Survolez une cat\xe9gorie pour voir les sous-cat\xe9gories"})})})]})]})})})]}):(0,s.jsx)("div",{ref:p,onMouseEnter:()=>a(!0),className:"relative",children:n})}function g(){var e,t,r,m,x,g,p,v;let b=(0,a.usePathname)(),w=(0,a.useRouter)(),{user:y,logout:j,loading:N,isAdmin:k,isClient:C,isUser:S,isVisitor:L}=(0,n.a)(),{favorites:M,removeFavorite:E}=(0,c.r)(),[_,z]=(0,i.useState)(""),[P,A]=(0,i.useState)(!1),[B,F]=(0,i.useState)(!1),[R,W]=(0,i.useState)([]),[O,T]=(0,i.useState)(!1),[I,U]=(0,i.useState)(null),[Z,q]=(0,i.useState)({}),H=(0,i.useRef)(null),D=(0,i.useRef)(null),J=(null==b?void 0:b.startsWith("/admin"))||"/register"===b||"/login"===b;(0,i.useEffect)(()=>{(async function(){try{let e=await (0,h.QQ)(),t=Array.isArray(e)?e:e.results||[];W(t)}catch(e){console.warn("Failed to load categories",e)}})()},[]),(0,i.useEffect)(()=>{I&&!Z[I]&&(async()=>{try{let e=R.find(e=>e.name===I);if(e){let t=await (0,h.z6)(e.slug);q(e=>({...e,[I]:t}))}}catch(e){console.warn("Failed to load subcategories",e)}})()},[I,R,Z]),(0,i.useEffect)(()=>{function e(e){!D.current||D.current.contains(e.target)||e.target.closest("[data-mobile-menu-button]")||T(!1)}return O&&(document.addEventListener("mousedown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",e),document.body.style.overflow=""}},[O]);let V=()=>{j(),w.push("/")},Q=e=>{e.preventDefault(),_.trim()&&w.push("/search?q=".concat(encodeURIComponent(_.trim())))};return((0,i.useEffect)(()=>{function e(e){H.current&&!H.current.contains(e.target)&&A(!1)}return P&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[P]),J)?null:(0,s.jsxs)("header",{className:"bg-primary sticky top-0 z-50 shadow-lg",children:[(0,s.jsx)("div",{className:"border-b border-primary-dark/30 bg-primary-dark/20",children:(0,s.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between px-6 py-2",children:[(0,s.jsx)("nav",{className:"hidden items-center gap-6 text-xs font-medium text-white/80 md:flex",children:[{href:"/deals",label:"Bons plans"},{href:"/magic-tool",label:"L'outil magique"},{href:"/categories",label:"Cat\xe9gories"}].map(e=>(0,s.jsx)(o.default,{href:e.href,className:"transition-colors hover:text-white",children:e.label},e.href))}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"hidden items-center gap-3 md:flex",children:[(0,s.jsx)("a",{href:"https://www.facebook.com",target:"_blank",rel:"noopener noreferrer",className:"text-white/80 hover:text-white transition-colors","aria-label":"Facebook",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),(0,s.jsx)("a",{href:"https://www.instagram.com",target:"_blank",rel:"noopener noreferrer",className:"text-white/80 hover:text-white transition-colors","aria-label":"Instagram",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),(0,s.jsx)("a",{href:"https://www.linkedin.com",target:"_blank",rel:"noopener noreferrer",className:"text-white/80 hover:text-white transition-colors","aria-label":"LinkedIn",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})}),(0,s.jsx)("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"text-white/80 hover:text-white transition-colors","aria-label":"Twitter",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})})})]}),(0,s.jsx)("div",{className:"flex items-center gap-4 text-xs",children:N?(0,s.jsx)("span",{className:"text-white/60",children:"Chargement..."}):y?k||C?(0,s.jsxs)(o.default,{href:k?"/admin":"/dashboard",className:"flex items-center gap-2 text-white/90 hover:text-white transition-colors",children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:"Mon Tableau de bord"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Compte"})]}):null:(0,s.jsx)(o.default,{href:"/login",className:"text-white/90 hover:text-white transition-colors",children:"Connexion"})})]})]})}),(0,s.jsx)("div",{className:"border-b border-primary-dark/30",children:(0,s.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-4 px-6 py-4",children:[(0,s.jsx)(o.default,{href:"/",className:"flex-shrink-0",children:(0,s.jsx)(l.default,{src:"/images/avito-colors.jpeg",alt:"Avita",width:320,height:320,className:"h-16 sm:h-20 w-auto object-contain",priority:!0})}),(0,s.jsx)("form",{onSubmit:Q,className:"hidden lg:flex flex-1 max-w-2xl mx-8",children:(0,s.jsxs)("div",{className:"relative w-full",children:[(0,s.jsx)("input",{type:"search",value:_,onChange:e=>z(e.target.value),placeholder:"Rechercher un produit...",className:"w-full rounded-lg border border-white/20 bg-white/10 backdrop-blur-sm px-4 py-2.5 pl-10 pr-4 text-sm text-white placeholder-white/60 focus:border-white/40 focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30"}),(0,s.jsx)("svg",{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-white/60",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(0,s.jsxs)("div",{className:"hidden lg:flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"relative",ref:H,children:[(0,s.jsxs)("button",{onClick:()=>A(!P),className:"flex items-center gap-2 rounded-lg border border-white/20 bg-white/10 backdrop-blur-sm px-3 py-2 text-sm font-medium text-white hover:bg-white/20 transition-colors",type:"button",children:[(0,s.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Ma s\xe9lection"}),M.length>0&&(0,s.jsx)("span",{className:"rounded-full bg-secondary px-2 py-0.5 text-xs font-semibold text-white",children:M.length})]}),P&&(0,s.jsxs)("div",{className:"absolute right-0 top-full z-50 mt-2 w-80 rounded-xl border border-white/20 bg-white p-5 shadow-2xl",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-primary",children:"Produits favoris"}),(0,s.jsx)("button",{onClick:()=>A(!1),className:"rounded-full bg-gray-100 p-1 hover:bg-gray-200",type:"button",children:(0,s.jsx)(d.Z,{className:"h-5 w-5 text-gray-500"})})]}),0===M.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Ajoutez des produits pour les suivre facilement."}):(0,s.jsx)("ul",{className:"space-y-3 max-h-96 overflow-y-auto",children:M.map(e=>{var t,r;return(0,s.jsxs)("li",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(o.default,{href:"/product/".concat(e.slug),className:"font-medium text-gray-800 hover:text-primary block truncate",onClick:()=>A(!1),children:e.name}),(null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price)!==void 0&&(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["\xe0 partir de ",(null!==(r=e.lowestPrice)&&void 0!==r?r:e.lowest_price).toFixed(2)," MAD"]})]}),(0,s.jsx)("button",{onClick:()=>E(e.id),className:"flex-shrink-0 text-xs text-secondary hover:underline font-medium",type:"button",children:"Retirer"})]},e.id)})})]})]}),N?(0,s.jsx)("div",{className:"h-10 w-10 animate-pulse rounded-full bg-white/20"}):y?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[k?(0,s.jsx)(o.default,{href:"/admin",className:"flex h-10 w-10 items-center justify-center rounded-full bg-white/20 text-white text-sm font-semibold transition-colors hover:bg-white/30",title:"Aller au tableau de bord admin",children:((null===(e=y.first_name)||void 0===e?void 0:e[0])||(null===(t=y.username)||void 0===t?void 0:t[0])||y.email[0]||"U").toUpperCase()}):C?(0,s.jsx)(o.default,{href:"/dashboard",className:"flex h-10 w-10 items-center justify-center rounded-full bg-white/20 text-white text-sm font-semibold transition-colors hover:bg-white/30",children:((null===(r=y.first_name)||void 0===r?void 0:r[0])||(null===(m=y.username)||void 0===m?void 0:m[0])||y.email[0]||"U").toUpperCase()}):(0,s.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-white/20 text-white text-sm font-semibold",title:"Compte utilisateur",children:((null===(x=y.first_name)||void 0===x?void 0:x[0])||(null===(g=y.username)||void 0===g?void 0:g[0])||y.email[0]||"U").toUpperCase()}),(0,s.jsxs)("div",{className:"hidden lg:block",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white",children:y.first_name&&y.last_name?"".concat(y.first_name," ").concat(y.last_name):y.username||"Mon compte"}),(0,s.jsx)("button",{onClick:V,className:"text-xs text-white/70 hover:text-white transition-colors",children:"D\xe9connexion"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.default,{href:"/login",className:"hidden rounded-lg border border-white/20 bg-white/10 backdrop-blur-sm px-4 py-2 text-sm font-medium text-white hover:bg-white/20 transition-colors sm:inline-block",children:"Connexion"}),(0,s.jsx)(o.default,{href:"/register",className:"rounded-lg bg-secondary px-4 py-2 text-sm font-medium text-white hover:bg-secondary/90 transition-colors shadow-lg",children:"Inscription"})]})]}),(0,s.jsx)("button",{"data-mobile-menu-button":!0,onClick:()=>T(!0),className:"lg:hidden flex items-center justify-center w-10 h-10 rounded-lg text-white hover:bg-white/20 transition-colors","aria-label":"Ouvrir le menu",type:"button",children:(0,s.jsx)(u,{className:"h-6 w-6"})})]})}),(0,s.jsx)("div",{className:"border-b border-primary-dark/30 bg-primary-dark/10 relative",children:(0,s.jsx)("div",{className:"mx-auto max-w-7xl px-6",children:(0,s.jsxs)("nav",{className:"flex items-center gap-6 overflow-x-auto py-3 scrollbar-hide",children:[(0,s.jsx)(o.default,{href:"/deals",className:"whitespace-nowrap text-sm font-medium transition-colors ".concat(b.startsWith("/deals")?"text-white border-b-2 border-secondary pb-1":"text-white/80 hover:text-white"),children:"Bons plans"}),(0,s.jsx)(f,{isOpen:B,onOpenChange:F,children:(0,s.jsxs)("button",{className:"whitespace-nowrap text-sm font-medium transition-colors flex items-center gap-1 ".concat(B||b.startsWith("/categories")?"text-white border-b-2 border-secondary pb-1":"text-white/80 hover:text-white"),type:"button",children:["Cat\xe9gories",(0,s.jsx)("svg",{className:"h-4 w-4 transition-transform ".concat(B?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})})}),O&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 lg:hidden",onClick:()=>T(!1)}),(0,s.jsxs)("div",{ref:D,className:"fixed left-0 top-0 h-full w-full max-w-sm bg-white z-50 shadow-2xl transform transition-transform duration-300 ease-in-out lg:hidden overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-primary p-4 flex items-center justify-between border-b border-primary-dark/30 z-10",children:[(0,s.jsx)(o.default,{href:"/",onClick:()=>T(!1),className:"flex-shrink-0",children:(0,s.jsx)(l.default,{src:"/images/avito-colors.jpeg",alt:"Avita",width:320,height:320,className:"h-12 w-auto object-contain",priority:!0})}),(0,s.jsx)("button",{onClick:()=>T(!1),className:"flex items-center justify-center w-10 h-10 rounded-lg text-white hover:bg-white/20 transition-colors","aria-label":"Fermer le menu",type:"button",children:(0,s.jsx)(d.Z,{className:"h-6 w-6"})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsx)("form",{onSubmit:e=>{Q(e),T(!1)},children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"search",value:_,onChange:e=>z(e.target.value),placeholder:"Rechercher un produit...",className:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 pl-10 pr-4 text-sm text-gray-900 placeholder-gray-500 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"}),(0,s.jsx)("svg",{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.default,{href:"/deals",onClick:()=>T(!1),className:"block px-4 py-3 rounded-lg text-base font-medium transition-colors ".concat(b.startsWith("/deals")?"bg-primary/10 text-primary":"text-gray-700 hover:bg-gray-100"),children:"Bons plans"}),(0,s.jsx)(o.default,{href:"/magic-tool",onClick:()=>T(!1),className:"block px-4 py-3 rounded-lg text-base font-medium transition-colors ".concat(b.startsWith("/magic-tool")?"bg-primary/10 text-primary":"text-gray-700 hover:bg-gray-100"),children:"L'outil magique"})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,s.jsx)("h3",{className:"px-4 py-2 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:"Cat\xe9gories"}),(0,s.jsx)("div",{className:"space-y-1",children:R.map(e=>{let t=I===e.name,r=Z[e.name]||[];return(0,s.jsxs)("div",{children:[(0,s.jsxs)("button",{onClick:()=>U(t?null:e.name),className:"w-full flex items-center justify-between px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:bg-gray-100 transition-colors",type:"button",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsx)("svg",{className:"h-5 w-5 transition-transform ".concat(t?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&(0,s.jsx)("div",{className:"pl-4 mt-1 space-y-1",children:r.length>0?r.map(e=>(0,s.jsx)(o.default,{href:"/categories/".concat(e.slug),onClick:()=>T(!1),className:"block px-4 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-100 transition-colors",children:e.name},e.id)):(0,s.jsx)("div",{className:"px-4 py-2 text-sm text-gray-500",children:"Chargement..."})})]},e.id)})})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 pt-4",children:N?(0,s.jsx)("div",{className:"px-4 py-3",children:(0,s.jsx)("div",{className:"h-10 w-full animate-pulse rounded bg-gray-200"})}):y?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg bg-gray-50",children:[(0,s.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-primary text-white text-lg font-semibold",children:((null===(p=y.first_name)||void 0===p?void 0:p[0])||(null===(v=y.username)||void 0===v?void 0:v[0])||y.email[0]||"U").toUpperCase()}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-900 truncate",children:y.first_name&&y.last_name?"".concat(y.first_name," ").concat(y.last_name):y.username||y.email}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:y.email})]})]}),(k||C)&&(0,s.jsxs)(o.default,{href:k?"/admin":"/dashboard",onClick:()=>T(!1),className:"flex items-center gap-3 px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Mon Tableau de bord"]}),(0,s.jsxs)("button",{onClick:()=>{A(!0),T(!1)},className:"w-full flex items-center justify-between px-4 py-3 rounded-lg text-base font-medium text-gray-700 hover:bg-gray-100 transition-colors",type:"button",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,s.jsx)("span",{children:"Ma s\xe9lection"})]}),M.length>0&&(0,s.jsx)("span",{className:"rounded-full bg-secondary px-2.5 py-0.5 text-xs font-semibold text-white",children:M.length})]}),(0,s.jsxs)("button",{onClick:()=>{V(),T(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-base font-medium text-red-600 hover:bg-red-50 transition-colors",type:"button",children:[(0,s.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"D\xe9connexion"]})]}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.default,{href:"/login",onClick:()=>T(!1),className:"block w-full text-center px-4 py-3 rounded-lg border border-primary text-primary font-medium hover:bg-primary/10 transition-colors",children:"Connexion"}),(0,s.jsx)(o.default,{href:"/register",onClick:()=>T(!1),className:"block w-full text-center px-4 py-3 rounded-lg bg-secondary text-white font-medium hover:bg-secondary/90 transition-colors",children:"Inscription"})]})})]})]})]})]})}let p=[{href:"/about",label:"\xc0 propos"},{href:"/faq",label:"FAQ"},{href:"/contact",label:"Contact"},{href:"/terms",label:"Conditions d'utilisation"}],v=[{href:"https://www.facebook.com",label:"Facebook"},{href:"https://www.instagram.com",label:"Instagram"},{href:"https://www.linkedin.com",label:"LinkedIn"}];function b(){let e=(0,a.usePathname)();return(null==e?void 0:e.startsWith("/admin"))||"/register"===e||"/login"===e?null:(0,s.jsxs)("footer",{className:"bg-primary text-white",children:[(0,s.jsxs)("div",{className:"mx-auto grid max-w-6xl gap-12 px-6 py-16 md:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o.default,{href:"/",className:"inline-block",children:(0,s.jsx)(l.default,{src:"/images/avito-colors.jpeg",alt:"Avita",width:120,height:40,className:"h-10 w-auto object-contain mb-4",priority:!0})}),(0,s.jsx)("p",{className:"mt-4 text-sm leading-relaxed text-white/80",children:"Avita compare les prix des meilleurs marchands marocains pour vous aider \xe0 trouver les bons plans high-tech et \xe9lectrom\xe9nager."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-white",children:"Informations"}),(0,s.jsx)("ul",{className:"mt-4 space-y-2 text-sm",children:p.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)(o.default,{href:e.href,className:"transition-colors hover:text-secondary text-white/80",children:e.label})},e.href))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-white",children:"Suivez-nous"}),(0,s.jsx)("ul",{className:"mt-4 space-y-2 text-sm",children:v.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:e.href,className:"transition-colors hover:text-secondary text-white/80",children:e.label})},e.href))})]})]}),(0,s.jsxs)("div",{className:"bg-primary-dark py-6 text-center text-xs text-white/60",children:["\xa9 ",new Date().getFullYear()," Avita â€” Tous droits r\xe9serv\xe9s."]})]})}function w(){return null}function y(e){let{children:t}=e,r=(0,a.usePathname)(),{isAdmin:o}=(0,n.a)(),l=null==r?void 0:r.startsWith("/admin"),i="/register"===r||"/login"===r,c=null==r?void 0:r.startsWith("/forgot-password"),d=(null==r?void 0:r.includes("/products/"))&&(null==r?void 0:r.includes("/edit")),u=o&&r&&(["/products/create","/products/upload"].includes(r)||d);return l||i||c||u?(0,s.jsx)("main",{className:"flex-1",children:t}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g,{}),(0,s.jsx)("main",{className:"flex-1",children:t}),(0,s.jsx)(b,{}),(0,s.jsx)(w,{})]})}},1390:function(e,t,r){"use strict";r.d(t,{default:function(){return o}});var s=r(7437),a=r(6463),n=r(3429);function o(e){let{children:t}=e,r=(0,a.usePathname)(),{isAdmin:o}=(0,n.a)(),l=null==r?void 0:r.startsWith("/admin"),i=(null==r?void 0:r.includes("/products/"))&&(null==r?void 0:r.includes("/edit")),c=o&&r&&(["/products/create","/products/upload"].includes(r)||i),d=null==r?void 0:r.startsWith("/forgot-password"),u=r&&(["/register","/login"].includes(r)||d);return l||c||u?(0,s.jsx)("div",{className:"h-full w-full",children:t}):(0,s.jsx)("div",{className:"mx-auto max-w-6xl px-6 py-10",children:t})}},3429:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return d}});var s=r(7437),a=r(2265),n=r(9988);let o=(0,a.createContext)(void 0),l="primini_auth";function i(e){if(!e){console.warn("getAuthHeader called with null tokens");return}if(e.access){let t={Authorization:"Bearer ".concat(e.access)};return console.log("Using Bearer token for auth"),t}if(e.key){let t={Authorization:"Token ".concat(e.key)};return console.log("Using Token for auth, token length:",e.key.length),t}console.warn("No valid token found in tokens object:",e)}function c(e){let{children:t}=e,[r,c]=function(){let[e,t]=(0,a.useState)(()=>{let e=window.localStorage.getItem(l);if(!e)return console.log("No stored auth tokens found"),null;try{var t;let r=JSON.parse(e);return console.log("Loaded tokens from localStorage:",{hasKey:!!r.key,hasAccess:!!r.access,keyLength:(null===(t=r.key)||void 0===t?void 0:t.length)||0}),r}catch(e){return console.warn("Failed to parse auth tokens",e),null}});return[e,(0,a.useCallback)(e=>{if(t(e),e){var r;console.log("Storing tokens to localStorage:",{hasKey:!!e.key,hasAccess:!!e.access,keyLength:(null===(r=e.key)||void 0===r?void 0:r.length)||0}),window.localStorage.setItem(l,JSON.stringify(e))}else console.log("Clearing tokens from localStorage"),window.localStorage.removeItem(l)},[])]}(),[d,u]=(0,a.useState)(null),[h,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{!async function(){if(m(!0),!(null==r?void 0:r.access)&&!(null==r?void 0:r.key)){u(null),m(!1);return}try{let e=i(r);console.log("Fetching user on mount/update with headers:",e);let t=await n.Z.get("/auth/user/",{headers:e});console.log("User fetched successfully:",JSON.stringify(t.data,null,2)),console.log("User role from API:",t.data.role);let s={...t.data,role:t.data.role||"visitor"};console.log("Setting user data:",JSON.stringify(s,null,2)),console.log("isAdmin will be:","admin"===s.role),u(s)}catch(r){var e,t,s;console.error("Failed to fetch user profile:",r),console.error("Error response:",null===(e=r.response)||void 0===e?void 0:e.data),console.error("Error status:",null===(t=r.response)||void 0===t?void 0:t.status),(null===(s=r.response)||void 0===s?void 0:s.status)===401&&(c(null),u(null))}finally{m(!1)}}()},[c,r]);let x=(0,a.useCallback)(async(e,t)=>{let r=await n.Z.post("/auth/login/",{email:e,password:t});console.log("Login response:",r.data),console.log("Login response keys:",Object.keys(r.data||{}));let s=r.data,a={key:s.key||s.token||s.token_key,access:s.access,refresh:s.refresh};if(!a.key&&!a.access)throw console.error("No token received in login response:",r.data),console.error("Response structure:",JSON.stringify(r.data,null,2)),Error("Aucun token re\xe7u lors de la connexion. R\xe9ponse: "+JSON.stringify(r.data));console.log("Token extracted successfully:",{hasKey:!!a.key,hasAccess:!!a.access,keyPreview:a.key?a.key.substring(0,10)+"...":"none"}),c(a);try{let e=i(a);console.log("Fetching user with headers:",e);let t=await n.Z.get("/auth/user/",{headers:e});console.log("User response:",JSON.stringify(t.data,null,2)),console.log("User role from API:",t.data.role);let r={...t.data,role:t.data.role||"visitor"};console.log("Setting user data:",JSON.stringify(r,null,2)),u(r)}catch(e){var o,l;throw console.error("Failed to fetch user profile after login:",e),console.error("Error response:",null===(o=e.response)||void 0===o?void 0:o.data),console.error("Error status:",null===(l=e.response)||void 0===l?void 0:l.status),e}},[c]),f=(0,a.useCallback)(async e=>{await n.Z.post("/auth/registration/",e)},[]),g=(0,a.useCallback)(()=>{c(null),u(null)},[c]),p=(0,a.useMemo)(()=>(null==d?void 0:d.role)==="admin",[d]),v=(0,a.useMemo)(()=>(null==d?void 0:d.role)==="client",[d]),b=(0,a.useMemo)(()=>(null==d?void 0:d.role)==="user",[d]),w=(0,a.useMemo)(()=>(null==d?void 0:d.role)==="visitor",[d]),y=(0,a.useMemo)(()=>({user:d,tokens:r,loading:h,isAdmin:p,isClient:v,isUser:b,isVisitor:w,login:x,register:f,logout:g}),[h,x,g,f,r,d,p,v,b,w]);return(0,s.jsx)(o.Provider,{value:y,children:t})}function d(){let e=(0,a.useContext)(o);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},8618:function(e,t,r){"use strict";r.d(t,{c:function(){return l},r:function(){return i}});var s=r(7437),a=r(2265);let n=(0,a.createContext)(void 0),o="primini_favorites";function l(e){let{children:t}=e,[r,l]=(0,a.useState)([]);(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem(o);e&&l(JSON.parse(e))}catch(e){console.warn("Failed to restore favorites",e)}},[]),(0,a.useEffect)(()=>{window.localStorage.setItem(o,JSON.stringify(r))},[r]);let i=(0,a.useCallback)(e=>{l(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),c=(0,a.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),d=(0,a.useCallback)(e=>r.some(t=>t.id===e),[r]),u=(0,a.useMemo)(()=>({favorites:r,addFavorite:i,removeFavorite:c,isFavorite:d}),[i,r,d,c]);return(0,s.jsx)(n.Provider,{value:u,children:t})}function i(){let e=(0,a.useContext)(n);if(!e)throw Error("useFavorites must be used within FavoritesProvider");return e}},9988:function(e,t,r){"use strict";var s,a=r(8472),n=r(357);let o=a.Z.create({baseURL:null!==(s=n.env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==s?s:"http://localhost:8000/api",withCredentials:!1});t.Z=o},1279:function(e,t,r){"use strict";r.d(t,{QQ:function(){return o},R:function(){return a},n3:function(){return l},tG:function(){return i},z6:function(){return n}});var s=r(9988);async function a(e,t){let r={};(null==t?void 0:t.subcategory)&&(r.subcategory=t.subcategory),(null==t?void 0:t.brand)&&(r.brand=t.brand),(null==t?void 0:t.price_min)!==void 0&&(r.price_min=t.price_min.toString()),(null==t?void 0:t.price_max)!==void 0&&(r.price_max=t.price_max.toString()),(null==t?void 0:t.tags)&&t.tags.length>0&&t.tags.forEach(e=>{r.tags=e}),(null==t?void 0:t.ordering)&&(r.ordering=t.ordering),(null==t?void 0:t.page)&&(r.page=t.page.toString()),(null==t?void 0:t.page_size)&&(r.page_size=t.page_size.toString());let a=(await s.Z.get("/categories/".concat(e,"/products/"),{params:r})).data;return{...a,results:a.results.map(e=>{var t;return{...e,lowestPrice:null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price}})}}async function n(e){let t=await s.Z.get("/categories/".concat(e,"/subcategories/"));return Array.isArray(t.data)?t.data:t.data.results||[]}async function o(e,t){let r={};return e&&(r.page=e.toString()),t&&(r.page_size=t.toString()),(await s.Z.get("/categories/parents/",{params:r})).data}async function l(e){return(await s.Z.get("/categories/".concat(e,"/"))).data}async function i(e){let t={};e&&(t.search=e);let r=await s.Z.get("/categories/",{params:{...t,page_size:"1000"}});return Array.isArray(r.data)?r.data:"results"in r.data&&r.data.results||[]}},6463:function(e,t,r){"use strict";var s=r(1169);r.o(s,"notFound")&&r.d(t,{notFound:function(){return s.notFound}}),r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},4573:function(e,t,r){"use strict";var s=r(2265);let a=s.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))});t.Z=a}},function(e){e.O(0,[8472,231,4974,2971,7023,1744],function(){return e(e.s=5322)}),_N_E=e.O()}]);