(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8565],{8565:function(e,t,r){Promise.resolve().then(r.bind(r,5517)),Promise.resolve().then(r.bind(r,912)),Promise.resolve().then(r.bind(r,1481))},5517:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var a=r(7437),s=r(2265),o=r(6463),n=r(9343),i=r(1014),l=r(3429),c=r(75),d=r(1279),u=r(6453),m=r(357);let p=["Samsung","Apple","LG","Sony","HP","Dell","Lenovo","Asus","Acer","Microsoft","Canon","Nikon","Panasonic","Philips","Bosch","Whirlpool","Electrolux","Tefal","SEB","Moulinex","Xiaomi","Huawei","Oppo","OnePlus","Realme","Vivo","Motorola","Nokia","Google","Amazon","JBL","Bose","Sennheiser","Logitech","Razer","Corsair","HyperX","SteelSeries","Intel","AMD","NVIDIA","Western Digital","Seagate","Kingston","SanDisk","Crucial","Garmin","Fitbit","Apple Watch","Samsung Galaxy","iPad","Surface","MacBook","ThinkPad","Alienware","ROG","Predator","Nitro","Inspiron","XPS","Vostro","Latitude","Yoga","IdeaPad","Legion","ZenBook","VivoBook","TUF","ProArt","Chromebook","AirPods","Beats","Sony WH","Sony WF","Bose QuietComfort","Bose SoundLink","JBL Flip","JBL Charge","UE Boom","Anker","Belkin","Mophie","Spigen","OtterBox","Case-Mate","Incipio","Tech21","ZAGG","Tempered Glass","Screen Protector","Wireless Charger","Power Bank","USB-C Cable","Lightning Cable","HDMI Cable","Ethernet Cable","Router","Modem","Switch","Access Point","Range Extender","Mesh System","Smart Home","Smart Speaker","Smart Display","Smart Thermostat","Smart Lock","Smart Camera","Smart Doorbell","Smart Light","Smart Plug","Smart Switch","Smart Hub","HomeKit","Alexa","Google Home","Nest","Ring","Arlo","Wyze","Eufy","TP-Link","Netgear","Linksys","ASUS Router","D-Link","Zyxel","Ubiquiti","MikroTik","Fritz!Box","AVM","Speedport","Easybox","Magenta","Orange","SFR","Bouygues","Free","Red","Sosh","B&You","La Poste Mobile","NRJ Mobile","Prixtel","Cdiscount Mobile","Lebara","LycaMobile","Vectone","Reglo Mobile","Cora Mobile","Auchan Mobile","Carrefour Mobile","Leclerc Mobile","Intermarch\xe9 Mobile","Syst\xe8me U Mobile","Casino Mobile","Monoprix Mobile","Fnac Mobile","Darty Mobile","Boulanger Mobile","LDLC Mobile","Materiel.net Mobile","Rue du Commerce Mobile","Cdiscount","Amazon","Fnac","Darty","Boulanger","LDLC","Materiel.net","Rue du Commerce","Rakuten","eBay","AliExpress","Wish","Veepee","Vente-privee.com","Showroomprive.com","Brandalley","Spartoo","Zalando","ASOS","Vinted","Le Bon Coin","Leboncoin","Facebook Marketplace","Marketplace","Autre"].sort();function g(){var e,t;let r=(0,o.useRouter)(),g=(0,o.useParams)(),{tokens:h}=(0,l.a)(),f=null==g?void 0:g.slug,x=!!f,[b,y]=(0,s.useState)(!1),[v,w]=(0,s.useState)(!1),[j,_]=(0,s.useState)(null),[k,N]=(0,s.useState)(null),[L,S]=(0,s.useState)([]),[C,A]=(0,s.useState)([]),[M,P]=(0,s.useState)(null),[E,R]=(0,s.useState)(""),[B,Z]=(0,s.useState)([]),[z,F]=(0,s.useState)([]),[D,I]=(0,s.useState)([]),[T,U]=(0,s.useState)([]),[q,O]=(0,s.useState)([]),[W,J]=(0,s.useState)(0),[G,V]=(0,s.useState)("select"),[H,Y]=(0,s.useState)(""),[X,K]=(0,s.useState)(!1),[$,Q]=(0,s.useState)(""),[ee,et]=(0,s.useState)(!1),[er,ea]=(0,s.useState)({}),[es,eo]=(0,s.useState)({}),[en,ei]=(0,s.useState)({}),[el,ec]=(0,s.useState)([{merchant_id:"",merchant_name:"",price:"",url:"",stock_status:"in_stock",currency:"MAD"}]),ed=H?p.filter(e=>e.toLowerCase().includes(H.toLowerCase())):p,eu=$?L.filter(e=>e.name.toLowerCase().includes($.toLowerCase())):L,em=e=>{let t=es[e]||"";return t?C.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())):C},{register:ep,handleSubmit:eg,formState:{errors:eh},setValue:ef,watch:ex,reset:eb}=(0,n.cI)({resolver:(0,i.F)(u.Iy),defaultValues:{name:"",description:"",brand:"",category_id:void 0,image:"",tags:[],specs:{},release_date:""}}),ey=ex("tags"),ev=ex("image");(0,s.useEffect)(()=>{if(ev&&ev.trim())try{let e=new URL(ev.trim()).toString(),t=T.filter(e=>e.startsWith("data:")),r=T.findIndex(t=>!t.startsWith("data:")&&t===e);if(-1===r){let r=[...t,e];U(r),O([e]),J(t.length)}else J(r)}catch(e){}else{let e=T.filter(e=>e.startsWith("data:"));e.length!==T.length&&(U(e),O([]),e.length>0?J(W<e.length?W:e.length-1):J(0))}},[ev]);let ew=(0,s.useCallback)(async(e,t)=>{if(null==h?void 0:h.key){y(!0);try{var r;let a=await fetch("".concat(m.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000/api","/products/").concat(e,"/"),{headers:{Authorization:"Token ".concat(h.key)}});if(!a.ok)throw Error("Failed to load product");let s=await a.json();if(P(s),eb({name:s.name||"",description:s.description||"",brand:s.brand||"",category_id:null===(r=s.category)||void 0===r?void 0:r.id,image:s.image||"",tags:s.tags||[],specs:s.specs||{},release_date:s.release_date||""}),s.brand){let e=p.includes(s.brand);V(e?"select":"manual"),e&&Y(s.brand)}else V("select"),Y("");if(s.images&&s.images.length>0){let e=[...s.images].sort((e,t)=>(e.order||0)-(t.order||0)).map(e=>e.image_url||e.image||"").filter(e=>e&&(e.startsWith("http://")||e.startsWith("https://")));U(e),O(e)}else if(s.image){let e=s.image;e&&(e.startsWith("http://")||e.startsWith("https://"))&&(U([e]),O([e]))}if(s.offers&&s.offers.length>0){let e=s.offers.map((e,r)=>{var a,s,o;let n={merchant_id:(null===(a=e.merchant)||void 0===a?void 0:a.id)||"",merchant_name:"",price:(null===(s=e.price)||void 0===s?void 0:s.toString())||"",url:e.url||"",stock_status:e.stock_status||"in_stock",currency:e.currency||"MAD"};return(null===(o=e.merchant)||void 0===o?void 0:o.id)&&(t.some(t=>t.id===e.merchant.id)?ea(e=>({...e,[r]:"select"})):(ea(e=>({...e,[r]:"manual"})),n.merchant_name=e.merchant.name,n.merchant_id="")),n});ec(e)}else ec([{merchant_id:"",merchant_name:"",price:"",url:"",stock_status:"in_stock",currency:"MAD"}])}catch(e){console.error("Failed to load product",e),_("Erreur lors du chargement du produit")}finally{y(!1)}}},[h,eb]);(0,s.useEffect)(()=>{(null==h?void 0:h.key)&&(Promise.all([(0,d.tG)().catch(e=>(console.error("Failed to load categories",e),[])),(0,c.pF)().catch(e=>(console.error("Failed to load merchants",e),[]))]).then(e=>{let[t,r]=e;console.log("Loaded categories:",t.length),S(t),A(r),x&&f&&ew(f,r)}),fetch("".concat(m.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000/api","/products/?page_size=1000")).then(e=>e.json()).then(e=>{let t=new Set;(e.results||[]).forEach(e=>{e.tags&&Array.isArray(e.tags)&&e.tags.forEach(e=>{e&&"string"==typeof e&&t.add(e.toLowerCase().trim())})}),Z(Array.from(t).sort())}).catch(e=>{console.error("Failed to load tags",e)}))},[h,x,f,ew]);let ej=e=>{el.length>1&&ec(el.filter((t,r)=>r!==e))},e_=(e,t,r)=>{let a=[...el];a[e]={...a[e],[t]:r},ec(a)},ek=async e=>{_(null),N(null),w(!0);try{if(!(null==h?void 0:h.key))throw Error("Non authentifi\xe9");let t=el.filter(e=>{let t=""!==e.merchant_id&&null!==e.merchant_id&&void 0!==e.merchant_id||e.merchant_name&&""!==e.merchant_name.trim(),r=e.price&&""!==e.price.toString().trim()&&!isNaN(Number(e.price))&&Number(e.price)>0;return t&&r}).map(e=>({merchant_id:""!==e.merchant_id&&"number"==typeof e.merchant_id?e.merchant_id:void 0,merchant_name:e.merchant_name&&""!==e.merchant_name.trim()?e.merchant_name.trim():void 0,price:Number(e.price),url:e.url&&""!==e.url.trim()?e.url.trim():void 0,stock_status:e.stock_status||"in_stock",currency:e.currency||"MAD"})),a=new FormData;a.append("name",e.name),e.description&&a.append("description",e.description),e.brand&&a.append("brand",e.brand),e.category_id&&a.append("category_id",e.category_id.toString()),e.image&&a.append("image",e.image),e.tags&&e.tags.length>0&&e.tags.forEach(e=>a.append("tags",e)),e.specs&&a.append("specs",JSON.stringify(e.specs)),e.release_date&&a.append("release_date",e.release_date),D.forEach(e=>{a.append("images",e)}),q.forEach(e=>{a.append("image_urls",e)}),x?t.length>0&&t.forEach((e,t)=>{e.merchant_id&&a.append("offers[".concat(t,"][merchant_id]"),e.merchant_id.toString()),e.merchant_name&&a.append("offers[".concat(t,"][merchant_name]"),e.merchant_name),a.append("offers[".concat(t,"][price]"),e.price.toString()),e.url&&a.append("offers[".concat(t,"][url]"),e.url),e.stock_status&&a.append("offers[".concat(t,"][stock_status]"),e.stock_status),e.currency&&a.append("offers[".concat(t,"][currency]"),e.currency)}):t.length>0&&t.forEach((e,t)=>{e.merchant_id&&a.append("offers[".concat(t,"][merchant_id]"),e.merchant_id.toString()),e.merchant_name&&a.append("offers[".concat(t,"][merchant_name]"),e.merchant_name),a.append("offers[".concat(t,"][price]"),e.price.toString()),e.url&&a.append("offers[".concat(t,"][url]"),e.url),e.stock_status&&a.append("offers[".concat(t,"][stock_status]"),e.stock_status),e.currency&&a.append("offers[".concat(t,"][currency]"),e.currency)});let s="".concat(m.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000/api","/products/"),o=x&&f?"PUT":"POST",n=x&&f?"".concat(s).concat(f,"/"):s,i=await fetch(n,{method:o,headers:{Authorization:"Token ".concat(h.key)},body:a});if(!i.ok){let e=await i.json().catch(()=>({}));if(console.error("Update error:",e),e.offers){let t=e.offers.map((e,t)=>"Offre ".concat(t+1,": ").concat(JSON.stringify(e))).join("\n");throw Error("Erreurs de validation des offres:\n".concat(t))}throw Error(e.detail||e.message||JSON.stringify(e)||"Une erreur est survenue")}x&&f?N("Produit mis \xe0 jour avec succ\xe8s!"):N("Produit cr\xe9\xe9 avec succ\xe8s! En attente d'approbation."),setTimeout(()=>{r.push("/")},2e3)}catch(e){_(e.message||"Une erreur est survenue")}finally{w(!1)}},eN=e=>{let t=(e||E).trim().toLowerCase();if(t){let e=ey||[];e.map(e=>e.toLowerCase()).includes(t)||(ef("tags",[...e,t],{shouldValidate:!0}),R(""),F([]))}},eL=e=>{if(R(e),e.trim().length>0){let t=e.trim().toLowerCase();F(B.filter(e=>e.includes(t)&&!(ey||[]).map(e=>e.toLowerCase()).includes(e)).slice(0,5))}else F([])},eS=e=>{ef("tags",(ey||[]).filter(t=>t!==e),{shouldValidate:!0})},eC=e=>{let t=T[e];if(q.includes(t))O(q.filter((t,r)=>T.findIndex(e=>e===q[r])!==e));else{let t=T.slice(0,e).filter(e=>!q.includes(e)).length;I(D.filter((e,r)=>r!==t))}let r=T.filter((t,r)=>r!==e);U(r),W>=r.length&&r.length>0?J(r.length-1):0===r.length&&J(0)};return b?(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"text-lg",children:"Chargement..."})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"mx-auto max-w-4xl",children:(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:x?"Modifier le produit":"Cr\xe9er un nouveau produit"}),j&&(0,a.jsx)("div",{className:"mb-4 rounded-md bg-red-50 p-4 text-red-800",children:j}),k&&(0,a.jsx)("div",{className:"mb-4 rounded-md bg-green-50 p-4 text-green-800",children:k}),M&&"pending"===M.approval_status&&(0,a.jsx)("div",{className:"mb-4 rounded-md bg-yellow-50 p-4 text-yellow-800",children:"Ce produit est en attente d'approbation."}),(0,a.jsxs)("form",{onSubmit:eg(ek),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations du produit"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-semibold text-gray-900 mb-2",children:"Nom du produit *"}),(0,a.jsx)("input",{type:"text",id:"name",...ep("name"),className:"mt-1 block w-full rounded-lg border-2 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(eh.name?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white"),placeholder:"Entrez le nom du produit"}),eh.name&&(0,a.jsx)("p",{className:"mt-1.5 text-sm font-medium text-red-600",children:eh.name.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"description",className:"block text-sm font-semibold text-gray-900 mb-2",children:["Description *",(0,a.jsx)("span",{className:"ml-2 text-xs font-normal text-gray-500",children:"(Minimum 500 caract\xe8res)"})]}),(0,a.jsx)("textarea",{id:"description",rows:6,...ep("description"),className:"mt-1 block w-full rounded-lg border-2 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 resize-y ".concat(eh.description?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white"),placeholder:"D\xe9crivez le produit en d\xe9tail (minimum 500 caract\xe8res)..."}),(0,a.jsxs)("div",{className:"mt-1.5 flex items-center justify-between",children:[eh.description?(0,a.jsx)("p",{className:"text-sm font-medium text-red-600",children:eh.description.message}):(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[(null===(e=ex("description"))||void 0===e?void 0:e.length)||0," / 500 caract\xe8res minimum"]}),ex("description")&&ex("description").length>=500&&(0,a.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"âœ“ Longueur suffisante"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"brand",className:"block text-sm font-semibold text-gray-900 mb-2",children:"Marque"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{V("select"),Y(""),p.includes(ex("brand")||"")||ef("brand","")},className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ".concat("select"===G?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Liste"}),(0,a.jsx)("button",{type:"button",onClick:()=>{V("manual"),Y(""),K(!1)},className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ".concat("manual"===G?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Autre"})]}),"select"===G?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",id:"brand",value:ex("brand")||H,onChange:e=>{let t=e.target.value;Y(t),ef("brand",t),K(!0)},onFocus:()=>{K(!0)},onBlur:()=>{setTimeout(()=>{K(!1);let e=ex("brand")||"";if(e&&!p.some(t=>t.toLowerCase()===e.toLowerCase()));else if(e){let t=p.find(t=>t.toLowerCase()===e.toLowerCase());t&&(ef("brand",t),Y(""))}},200)},placeholder:"Rechercher ou s\xe9lectionner une marque...",className:"block w-full rounded-lg border-2 px-4 py-2.5 pr-10 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(eh.brand?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white")}),(0,a.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),X&&(ed.length>0||H)&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border-2 border-primary/30 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:ed.length>0?ed.map(e=>(0,a.jsx)("button",{type:"button",onMouseDown:t=>{t.preventDefault(),ef("brand",e),Y(""),K(!1)},className:"w-full text-left px-4 py-2.5 text-sm hover:bg-primary/10 hover:text-primary transition-colors border-b border-gray-100 last:border-b-0",children:e},e)):(0,a.jsx)("div",{className:"px-4 py-2.5 text-sm text-gray-500",children:'Aucune marque trouv\xe9e. Utilisez le bouton "Autre" pour ajouter une nouvelle marque.'})})]}):(0,a.jsx)("input",{type:"text",id:"brand",...ep("brand"),className:"block w-full rounded-lg border-2 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(eh.brand?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white"),placeholder:"Entrez le nom de la marque"})]}),eh.brand&&(0,a.jsx)("p",{className:"mt-1.5 text-sm font-medium text-red-600",children:eh.brand.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"category",className:"block text-sm font-semibold text-gray-900 mb-2",children:"Cat\xe9gorie"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",id:"category",value:(null===(t=L.find(e=>e.id===ex("category_id")))||void 0===t?void 0:t.name)||$,onChange:e=>{let t=e.target.value;Q(t),et(!0);let r=L.find(e=>e.name.toLowerCase()===t.toLowerCase());r?(ef("category_id",r.id),Q(""),et(!1)):ef("category_id",void 0)},onFocus:()=>{et(!0)},onBlur:()=>{setTimeout(()=>{et(!1);let e=ex("category_id");e&&L.find(t=>t.id===e)&&Q("")},200)},placeholder:"Rechercher ou s\xe9lectionner une cat\xe9gorie...",className:"block w-full rounded-lg border-2 px-4 py-2.5 pr-10 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(eh.category_id?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white")}),(0,a.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),ee&&(eu.length>0||$)&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border-2 border-primary/30 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:eu.length>0?eu.map(e=>(0,a.jsx)("button",{type:"button",onMouseDown:t=>{t.preventDefault(),ef("category_id",e.id),Q(""),et(!1)},className:"w-full text-left px-4 py-2.5 text-sm hover:bg-primary/10 hover:text-primary transition-colors border-b border-gray-100 last:border-b-0",children:e.name},e.id)):(0,a.jsx)("div",{className:"px-4 py-2.5 text-sm text-gray-500",children:"Aucune cat\xe9gorie trouv\xe9e"})})]}),eh.category_id&&(0,a.jsx)("p",{className:"mt-1.5 text-sm font-medium text-red-600",children:eh.category_id.message})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"images",className:"block text-sm font-semibold text-gray-900 mb-2",children:["Images du produit *",(0,a.jsx)("span",{className:"ml-2 text-xs font-normal text-gray-500",children:"(Vous pouvez t\xe9l\xe9charger plusieurs images)"})]}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("input",{type:"file",id:"images",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",onChange:e=>{let t=Array.from(e.target.files||[]);if(0===t.length)return;let r=t.filter(e=>["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type));if(r.length!==t.length){_("Certains fichiers ne sont pas des images valides (JPEG, PNG, WebP, GIF uniquement)");return}if(r.filter(e=>e.size>5242880).length>0){_("Certaines images sont trop volumineuses (maximum 5MB par image)");return}I([...D,...r]);let a=[];r.forEach(e=>{let t=new FileReader;t.onload=e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;a.push(r),U([...T,...a])},t.readAsDataURL(e)})},className:"hidden"}),(0,a.jsx)("label",{htmlFor:"images",className:"flex items-center justify-center w-full h-32 border-2 border-dashed border-primary/30 rounded-lg bg-primary/5 hover:bg-primary/10 cursor-pointer transition-colors",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-primary",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-semibold text-primary",children:"Cliquez pour t\xe9l\xe9charger"})," ou glissez-d\xe9posez"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, WebP, GIF jusqu'\xe0 5MB"})]})})]}),T.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"relative bg-gray-100 rounded-lg overflow-hidden",style:{aspectRatio:"16/9"},children:(0,a.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[(0,a.jsx)("img",{src:T[W],alt:"Image ".concat(W+1),className:"max-w-full max-h-full object-contain",onError:e=>{let t=e.target;t.style.display="none";let r=t.parentElement;if(r&&!r.querySelector(".image-error")){let e=document.createElement("div");e.className="image-error text-red-500 text-sm p-4 text-center",e.textContent="Impossible de charger cette image",r.appendChild(e)}},onLoad:e=>{let t=e.target,r=t.parentElement,a=null==r?void 0:r.querySelector(".image-error");a&&a.remove(),t.style.display="block"}}),T.length>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",onClick:()=>{T.length>0&&J(e=>(e-1+T.length)%T.length)},className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg transition-colors","aria-label":"Image pr\xe9c\xe9dente",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,a.jsx)("button",{type:"button",onClick:()=>{T.length>0&&J(e=>(e+1)%T.length)},className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg transition-colors","aria-label":"Image suivante",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),T.length>1&&(0,a.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/60 text-white px-3 py-1 rounded-full text-sm",children:[W+1," / ",T.length]})]})}),(0,a.jsx)("div",{className:"mt-3 flex gap-2 overflow-x-auto pb-2",children:T.map((e,t)=>(0,a.jsxs)("div",{className:"relative flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 cursor-pointer transition-all ".concat(t===W?"border-primary ring-2 ring-primary ring-offset-2":"border-gray-200 hover:border-primary/50"),onClick:()=>J(t),children:[(0,a.jsx)("img",{src:e,alt:"Thumbnail ".concat(t+1),className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),eC(t)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors","aria-label":"Supprimer l'image",children:(0,a.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},t))})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{htmlFor:"image_url",className:"block text-xs font-medium text-gray-600 mb-1",children:"Ou URL de l'image (optionnel)"}),(0,a.jsx)("input",{type:"url",id:"image_url",...ep("image"),className:"block w-full rounded-lg border-2 px-4 py-2 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(eh.image?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white"),placeholder:"https://example.com/image.jpg"}),eh.image&&(0,a.jsx)("p",{className:"mt-1.5 text-sm font-medium text-red-600",children:eh.image.message})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"release_date",className:"block text-sm font-semibold text-gray-900 mb-2",children:"Date de sortie (YYYY-MM-DD)"}),(0,a.jsx)("input",{type:"date",id:"release_date",...ep("release_date"),className:"mt-1 block w-full rounded-lg border-2 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(eh.release_date?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-primary/30 focus:border-primary focus:ring-primary bg-white")}),eh.release_date&&(0,a.jsx)("p",{className:"mt-1.5 text-sm font-medium text-red-600",children:eh.release_date.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"tags",className:"block text-sm font-semibold text-gray-900 mb-2",children:["Tags",(0,a.jsx)("span",{className:"ml-2 text-xs font-normal text-gray-500",children:"(Appuyez sur Entr\xe9e ou utilisez une virgule pour ajouter)"})]}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{type:"text",id:"tags",value:E,onChange:e=>eL(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),z.length>0?eN(z[0]):eN()):(","===e.key||";"===e.key)&&(e.preventDefault(),eN())},placeholder:"Tapez un tag et appuyez sur Entr\xe9e...",className:"w-full rounded-lg border-2 border-primary/30 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary focus:ring-offset-1 bg-white"}),z.length>0&&(0,a.jsx)("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-40 overflow-y-auto",children:z.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>eN(e),className:"w-full text-left px-3 py-2 text-sm hover:bg-primary/10 hover:text-primary transition-colors",children:e},e))})]}),(0,a.jsx)("button",{type:"button",onClick:()=>eN(),disabled:!E.trim(),className:"rounded-lg bg-primary px-6 py-2.5 text-sm font-semibold text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Ajouter"})]}),eh.tags&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:eh.tags.message}),ey&&ey.length>0&&(0,a.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:ey.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary border border-primary/20",children:[e,(0,a.jsx)("button",{type:"button",onClick:()=>eS(e),className:"text-primary hover:text-primary/80 font-bold text-base leading-none","aria-label":"Supprimer le tag ".concat(e),children:"\xd7"})]},e))}),B.length>0&&0===E.length&&(0,a.jsxs)("p",{className:"mt-2 text-xs text-gray-500",children:["Tags populaires: ",B.slice(0,10).join(", "),B.length>10&&"..."]})]})]})]})]}),(0,a.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Liens de comparaison"}),(0,a.jsx)("button",{type:"button",onClick:()=>{ec([...el,{merchant_id:"",merchant_name:"",price:"",url:"",stock_status:"in_stock",currency:"MAD"}])},className:"rounded-md bg-primary px-4 py-2 text-sm font-medium text-white hover:bg-primary/90",children:"+ Ajouter un lien"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Ajoutez plusieurs liens de marchands pour permettre la comparaison des prix."}),(0,a.jsx)("div",{className:"space-y-4",children:el.map((e,t)=>{var r;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Lien ",t+1]}),el.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>ej(t),className:"text-sm text-red-600 hover:text-red-800",children:"Supprimer"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Marchand *"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{ea(e=>({...e,[t]:"select"})),eo(e=>({...e,[t]:""}));let r=e.merchant_id;r&&"number"==typeof r&&!C.find(e=>e.id===r)&&e_(t,"merchant_id","")},className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ".concat("select"===(er[t]||"select")?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Liste"}),(0,a.jsx)("button",{type:"button",onClick:()=>{ea(e=>({...e,[t]:"manual"})),eo(e=>({...e,[t]:""})),ei(e=>({...e,[t]:!1})),e_(t,"merchant_id","")},className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ".concat("manual"===(er[t]||"select")?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Autre"})]}),"select"===(er[t]||"select")?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:e.merchant_id&&"number"==typeof e.merchant_id?(null===(r=C.find(t=>t.id===e.merchant_id))||void 0===r?void 0:r.name)||es[t]||"":es[t]||"",onChange:e=>{let r=e.target.value;eo(e=>({...e,[t]:r}));let a=C.find(e=>e.name.toLowerCase()===r.toLowerCase());a?(e_(t,"merchant_id",a.id),eo(e=>({...e,[t]:""})),ei(e=>({...e,[t]:!1}))):(e_(t,"merchant_id",""),ei(e=>({...e,[t]:!0})))},onFocus:()=>{(es[t]||!e.merchant_id)&&ei(e=>({...e,[t]:!0}))},onBlur:()=>{setTimeout(()=>{ei(e=>({...e,[t]:!1})),es[t]&&!C.some(e=>{var r;return e.name.toLowerCase()===(null===(r=es[t])||void 0===r?void 0:r.toLowerCase())})&&eo(e=>({...e,[t]:""}))},200)},placeholder:"Rechercher ou s\xe9lectionner un marchand...",className:"block w-full rounded-lg border-2 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(e.merchant_id||0!==t?"border-primary/30 focus:border-primary focus:ring-primary bg-white":"border-red-500 focus:border-red-500 focus:ring-red-500")}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),en[t]&&(em(t).length>0||es[t])&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border-2 border-primary/30 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:em(t).length>0?em(t).map(e=>(0,a.jsx)("button",{type:"button",onMouseDown:r=>{r.preventDefault(),e_(t,"merchant_id",e.id),eo(e=>({...e,[t]:""})),ei(e=>({...e,[t]:!1}))},className:"w-full text-left px-4 py-2.5 text-sm hover:bg-primary/10 hover:text-primary transition-colors border-b border-gray-100 last:border-b-0",children:e.name},e.id)):(0,a.jsx)("div",{className:"px-4 py-2.5 text-sm text-gray-500",children:'Aucun marchand trouv\xe9. Utilisez le bouton "Autre" pour ajouter un nouveau marchand.'})})]}):(0,a.jsx)("input",{type:"text",value:e.merchant_name||"",onChange:e=>{let r=[...el];r[t]={...r[t],merchant_name:e.target.value},ec(r)},placeholder:"Entrez le nom du marchand manuellement",className:"block w-full rounded-lg border-2 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 border-primary/30 focus:border-primary focus:ring-primary bg-white"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Prix (MAD) *"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",value:e.price,onChange:e=>e_(t,"price",e.target.value),className:"w-full rounded-lg border-2 border-primary/30 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary focus:ring-offset-1 bg-white",placeholder:"0.00",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"URL du produit"}),(0,a.jsx)("input",{type:"url",value:e.url,onChange:e=>e_(t,"url",e.target.value),className:"w-full rounded-lg border-2 border-primary/30 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary focus:ring-offset-1 bg-white",placeholder:"https://..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Statut du stock"}),(0,a.jsxs)("select",{value:e.stock_status,onChange:e=>e_(t,"stock_status",e.target.value),className:"w-full rounded-lg border-2 border-primary/30 px-4 py-2.5 text-sm transition-colors focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary focus:ring-offset-1 bg-white",children:[(0,a.jsx)("option",{value:"in_stock",children:"En stock"}),(0,a.jsx)("option",{value:"low_stock",children:"Stock faible"}),(0,a.jsx)("option",{value:"out_of_stock",children:"Rupture de stock"})]})]})]})]},t)})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:()=>r.back(),className:"rounded-lg border-2 border-gray-300 bg-white px-6 py-2.5 text-sm font-semibold text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors",children:"Annuler"}),(0,a.jsx)("button",{type:"submit",disabled:v,className:"rounded-lg bg-primary px-6 py-2.5 text-sm font-semibold text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm",children:v?"Enregistrement...":x?"Mettre \xe0 jour":"Cr\xe9er le produit"})]})]})]})})})}function h(){return(0,a.jsx)(g,{})}},3429:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return d}});var a=r(7437),s=r(2265),o=r(9988);let n=(0,s.createContext)(void 0),i="primini_auth";function l(e){if(!e){console.warn("getAuthHeader called with null tokens");return}if(e.access){let t={Authorization:"Bearer ".concat(e.access)};return console.log("Using Bearer token for auth"),t}if(e.key){let t={Authorization:"Token ".concat(e.key)};return console.log("Using Token for auth, token length:",e.key.length),t}console.warn("No valid token found in tokens object:",e)}function c(e){let{children:t}=e,[r,c]=function(){let[e,t]=(0,s.useState)(()=>{let e=window.localStorage.getItem(i);if(!e)return console.log("No stored auth tokens found"),null;try{var t;let r=JSON.parse(e);return console.log("Loaded tokens from localStorage:",{hasKey:!!r.key,hasAccess:!!r.access,keyLength:(null===(t=r.key)||void 0===t?void 0:t.length)||0}),r}catch(e){return console.warn("Failed to parse auth tokens",e),null}});return[e,(0,s.useCallback)(e=>{if(t(e),e){var r;console.log("Storing tokens to localStorage:",{hasKey:!!e.key,hasAccess:!!e.access,keyLength:(null===(r=e.key)||void 0===r?void 0:r.length)||0}),window.localStorage.setItem(i,JSON.stringify(e))}else console.log("Clearing tokens from localStorage"),window.localStorage.removeItem(i)},[])]}(),[d,u]=(0,s.useState)(null),[m,p]=(0,s.useState)(!0);(0,s.useEffect)(()=>{!async function(){if(p(!0),!(null==r?void 0:r.access)&&!(null==r?void 0:r.key)){u(null),p(!1);return}try{let e=l(r);console.log("Fetching user on mount/update with headers:",e);let t=await o.Z.get("/auth/user/",{headers:e});console.log("User fetched successfully:",JSON.stringify(t.data,null,2)),console.log("User role from API:",t.data.role);let a={...t.data,role:t.data.role||"visitor"};console.log("Setting user data:",JSON.stringify(a,null,2)),console.log("isAdmin will be:","admin"===a.role),u(a)}catch(r){var e,t,a;console.error("Failed to fetch user profile:",r),console.error("Error response:",null===(e=r.response)||void 0===e?void 0:e.data),console.error("Error status:",null===(t=r.response)||void 0===t?void 0:t.status),(null===(a=r.response)||void 0===a?void 0:a.status)===401&&(c(null),u(null))}finally{p(!1)}}()},[c,r]);let g=(0,s.useCallback)(async(e,t)=>{let r=await o.Z.post("/auth/login/",{email:e,password:t});console.log("Login response:",r.data),console.log("Login response keys:",Object.keys(r.data||{}));let a=r.data,s={key:a.key||a.token||a.token_key,access:a.access,refresh:a.refresh};if(!s.key&&!s.access)throw console.error("No token received in login response:",r.data),console.error("Response structure:",JSON.stringify(r.data,null,2)),Error("Aucun token re\xe7u lors de la connexion. R\xe9ponse: "+JSON.stringify(r.data));console.log("Token extracted successfully:",{hasKey:!!s.key,hasAccess:!!s.access,keyPreview:s.key?s.key.substring(0,10)+"...":"none"}),c(s);try{let e=l(s);console.log("Fetching user with headers:",e);let t=await o.Z.get("/auth/user/",{headers:e});console.log("User response:",JSON.stringify(t.data,null,2)),console.log("User role from API:",t.data.role);let r={...t.data,role:t.data.role||"visitor"};console.log("Setting user data:",JSON.stringify(r,null,2)),u(r)}catch(e){var n,i;throw console.error("Failed to fetch user profile after login:",e),console.error("Error response:",null===(n=e.response)||void 0===n?void 0:n.data),console.error("Error status:",null===(i=e.response)||void 0===i?void 0:i.status),e}},[c]),h=(0,s.useCallback)(async e=>{await o.Z.post("/auth/registration/",e)},[]),f=(0,s.useCallback)(()=>{c(null),u(null)},[c]),x=(0,s.useMemo)(()=>(null==d?void 0:d.role)==="admin",[d]),b=(0,s.useMemo)(()=>(null==d?void 0:d.role)==="client",[d]),y=(0,s.useMemo)(()=>(null==d?void 0:d.role)==="user",[d]),v=(0,s.useMemo)(()=>(null==d?void 0:d.role)==="visitor",[d]),w=(0,s.useMemo)(()=>({user:d,tokens:r,loading:m,isAdmin:x,isClient:b,isUser:y,isVisitor:v,login:g,register:h,logout:f}),[m,g,f,h,r,d,x,b,y,v]);return(0,a.jsx)(n.Provider,{value:w,children:t})}function d(){let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9988:function(e,t,r){"use strict";var a,s=r(8472),o=r(357);let n=s.Z.create({baseURL:null!==(a=o.env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==a?a:"http://localhost:8000/api",withCredentials:!1});t.Z=n},1279:function(e,t,r){"use strict";r.d(t,{QQ:function(){return n},R:function(){return s},n3:function(){return i},tG:function(){return l},z6:function(){return o}});var a=r(9988);async function s(e,t){let r={};(null==t?void 0:t.subcategory)&&(r.subcategory=t.subcategory),(null==t?void 0:t.brand)&&(r.brand=t.brand),(null==t?void 0:t.price_min)!==void 0&&(r.price_min=t.price_min.toString()),(null==t?void 0:t.price_max)!==void 0&&(r.price_max=t.price_max.toString()),(null==t?void 0:t.tags)&&t.tags.length>0&&t.tags.forEach(e=>{r.tags=e}),(null==t?void 0:t.ordering)&&(r.ordering=t.ordering),(null==t?void 0:t.page)&&(r.page=t.page.toString()),(null==t?void 0:t.page_size)&&(r.page_size=t.page_size.toString());let s=(await a.Z.get("/categories/".concat(e,"/products/"),{params:r})).data;return{...s,results:s.results.map(e=>{var t;return{...e,lowestPrice:null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price}})}}async function o(e){let t=await a.Z.get("/categories/".concat(e,"/subcategories/"));return Array.isArray(t.data)?t.data:t.data.results||[]}async function n(e,t){let r={};return e&&(r.page=e.toString()),t&&(r.page_size=t.toString()),(await a.Z.get("/categories/parents/",{params:r})).data}async function i(e){return(await a.Z.get("/categories/".concat(e,"/"))).data}async function l(e){let t={};e&&(t.search=e);let r=await a.Z.get("/categories/",{params:{...t,page_size:"1000"}});return Array.isArray(r.data)?r.data:"results"in r.data&&r.data.results||[]}},75:function(e,t,r){"use strict";r.d(t,{BB:function(){return i},Dg:function(){return d},EE:function(){return g},b4:function(){return m},ch:function(){return n},ex:function(){return c},g4:function(){return o},h7:function(){return l},kR:function(){return h},pF:function(){return u},t$:function(){return f},zb:function(){return p}});var a=r(9988);function s(e){return e?{Authorization:"Token ".concat(e)}:{}}async function o(e,t){let r=new FormData;return r.append("file",e),(await a.Z.post("/products/upload_csv/",r,{headers:{...s(t),"Content-Type":"multipart/form-data"}})).data}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o={page:t.toString()};return r&&(o.approval_status=r),(await a.Z.get("/products/my_products/",{headers:s(e),params:o})).data}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(await a.Z.get("/products/pending/",{headers:s(e),params:{page:t}})).data}async function l(e,t){return(await a.Z.post("/products/".concat(e,"/approve/"),{action:"approve"},{headers:s(t)})).data}async function c(e,t,r){return(await a.Z.post("/products/".concat(e,"/approve/"),{action:"reject",rejection_reason:t},{headers:s(r)})).data}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,n={page:t.toString()};return r&&(n.approval_status=r),o&&(n.search=o),(await a.Z.get("/products/",{headers:s(e),params:n})).data}async function u(){let e=await a.Z.get("/merchants/",{params:{page_size:"1000"}});return Array.isArray(e.data)?e.data:e.data.results||[]}async function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(await a.Z.get("/products/with_description/",{params:{min_length:e,page:t,page_size:r}})).data}async function p(e,t){return(await a.Z.post("/offers/submit/",e,{headers:{Authorization:"Token ".concat(t)}})).data}async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(await a.Z.get("/offers/pending/",{headers:{Authorization:"Token ".concat(e)},params:{page:t}})).data}async function h(e,t){return(await a.Z.post("/offers/".concat(e,"/approve/"),{},{headers:{Authorization:"Token ".concat(t)}})).data}async function f(e,t,r){return(await a.Z.post("/offers/".concat(e,"/reject/"),{rejection_reason:t},{headers:{Authorization:"Token ".concat(r)}})).data}},6453:function(e,t,r){"use strict";r.d(t,{$T:function(){return l},Iy:function(){return s},cU:function(){return i},dm:function(){return o},xj:function(){return c}});var a=r(546);let s=a.Ryn({name:a.Z_8().min(1,"Le nom du produit est requis").min(3,"Le nom doit contenir au moins 3 caract\xe8res").max(200,"Le nom ne peut pas d\xe9passer 200 caract\xe8res"),description:a.Z_8().min(1,"La description est requise").min(500,"La description doit contenir au moins 500 caract\xe8res").max(5e3,"La description ne peut pas d\xe9passer 5000 caract\xe8res"),brand:a.Z_8().max(120,"La marque ne peut pas d\xe9passer 120 caract\xe8res").optional().or(a.i0J("")),category_id:a.G0j([a.Rxh().positive("Cat\xe9gorie invalide"),a.qnd(),a.S1Z()]).transform(e=>"number"!=typeof e||isNaN(e)?void 0:e).optional(),image:a.Z_8().refine(e=>!e||a.Z_8().url().safeParse(e).success,"URL invalide").optional().or(a.i0J("")),tags:a.IXX(a.Z_8().min(1,"Les tags ne peuvent pas \xeatre vides")).max(20,"Maximum 20 tags autoris\xe9s").optional(),specs:a.IMB(a.Z_8(),a.G0j([a.Z_8(),a.Rxh(),a.O72()])).optional(),release_date:a.Z_8().refine(e=>!e||/^\d{4}-\d{2}-\d{2}$/.test(e),"Format de date invalide (YYYY-MM-DD)").optional().or(a.i0J("")),source_category:a.Z_8().max(150,"La cat\xe9gorie source ne peut pas d\xe9passer 150 caract\xe8res").optional().or(a.i0J(""))}),o=a.Ryn({email:a.Z_8().min(1,"L'adresse email est requise").email("Format d'email invalide"),password:a.Z_8().min(1,"Le mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caract\xe8res")}),n=a.Ryn({username:a.Z_8().min(1,"Le nom d'utilisateur est requis").min(3,"Le nom d'utilisateur doit contenir au moins 3 caract\xe8res").max(150,"Le nom d'utilisateur ne peut pas d\xe9passer 150 caract\xe8res").regex(/^[a-zA-Z0-9_]+$/,"Le nom d'utilisateur ne peut contenir que des lettres, chiffres et underscores"),email:a.Z_8().min(1,"L'adresse email est requise").email("Format d'email invalide"),password1:a.Z_8().min(1,"Le mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caract\xe8res").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Le mot de passe doit contenir au moins une majuscule, une minuscule et un chiffre"),password2:a.Z_8().min(1,"La confirmation du mot de passe est requise"),first_name:a.Z_8().min(1,"Le pr\xe9nom est requis").max(150,"Le pr\xe9nom ne peut pas d\xe9passer 150 caract\xe8res"),last_name:a.Z_8().min(1,"Le nom est requis").max(150,"Le nom ne peut pas d\xe9passer 150 caract\xe8res")}),i=n.extend({enterprise_name:a.Z_8().min(1,"Le nom de l'entreprise est requis").max(200,"Le nom de l'entreprise ne peut pas d\xe9passer 200 caract\xe8res"),address:a.Z_8().min(1,"L'adresse est requise").max(500,"L'adresse ne peut pas d\xe9passer 500 caract\xe8res"),phone_number:a.Z_8().min(1,"Le num\xe9ro de t\xe9l\xe9phone est requis").max(20,"Le num\xe9ro de t\xe9l\xe9phone ne peut pas d\xe9passer 20 caract\xe8res").regex(/^[\d\s\-\+\(\)]+$/,"Le num\xe9ro de t\xe9l\xe9phone contient des caract\xe8res invalides")}).refine(e=>e.password1===e.password2,{message:"Les mots de passe ne correspondent pas",path:["password2"]}),l=n.refine(e=>e.password1===e.password2,{message:"Les mots de passe ne correspondent pas",path:["password2"]});a.Ryn({threshold:a.Z_8().min(1,"Le prix seuil est requis").refine(e=>!isNaN(Number(e))&&Number(e)>0,"Le prix doit \xeatre un nombre positif")});let c=a.Ryn({url:a.Z_8().min(1,"L'URL est requise").url("Format d'URL invalide")});a.Ryn({file:a.PpW(File).refine(e=>e.size<=10485760,"Le fichier ne peut pas d\xe9passer 10MB").refine(e=>e.name.endsWith(".csv"),"Le fichier doit \xeatre un fichier CSV")})},6463:function(e,t,r){"use strict";var a=r(1169);r.o(a,"notFound")&&r.d(t,{notFound:function(){return a.notFound}}),r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},912:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let a=r(5592);function s(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new a.BailoutToCSRError(t);return r}},1481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return o}});let a=r(7437),s=r(8512);function o(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,s.getExpectedRequestStore)("next/dynamic css"),o=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));o.push(...t)}}return 0===o.length?null:(0,a.jsx)(a.Fragment,{children:o.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}}]);