"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1340],{6847:function(e,t,s){s.d(t,{Z:function(){return o}});var l=s(7437),a=s(6648),r=s(7138),i=s(2265),n=s(8618),d=s(357);function o(e){var t,s;let{product:o}=e,{addFavorite:c,removeFavorite:m,isFavorite:x}=(0,n.r)(),u=x(o.id),[p,h]=(0,i.useState)(!1),[b,f]=(0,i.useState)(null),g=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/media/")||e.startsWith("media/")){let t=d.env.NEXT_PUBLIC_API_BASE_URL?d.env.NEXT_PUBLIC_API_BASE_URL.replace("/api",""):"http://localhost:8000",s=e.startsWith("/")?e:"/".concat(e);return"".concat(t).concat(s)}if(!e.startsWith("/")){let t=d.env.NEXT_PUBLIC_API_BASE_URL?d.env.NEXT_PUBLIC_API_BASE_URL.replace("/api",""):"http://localhost:8000";return"".concat(t,"/media/products/").concat(e)}return e},v=(0,i.useMemo)(()=>o.image_display?o.image_display:o.image_file?g(o.image_file):o.image?g(o.image):null,[o.image_display,o.image_file,o.image]),j=(null===(t=o.tags)||void 0===t?void 0:t.slice(0,3))||[],y=null!==(s=o.lowestPrice)&&void 0!==s?s:o.lowest_price,w=null!=y?"string"==typeof y?parseFloat(y):y:null,N=b||v;return(0,l.jsx)(r.default,{href:"/product/".concat(o.slug),className:"block h-full",children:(0,l.jsxs)("article",{className:"flex h-full flex-col justify-between rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[N&&!p?(0,l.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden rounded-2xl bg-white",children:[j.length>0&&(0,l.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:j.map((e,t)=>(0,l.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,l.jsx)("div",{className:"absolute inset-2 sm:inset-3",children:(0,l.jsx)(a.default,{src:N,alt:o.name,fill:!0,className:"object-contain transition-transform duration-300 hover:scale-105",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw",quality:90,priority:!1,loading:"lazy",placeholder:"blur",blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mN8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",onError:()=>{let e=b===o.image_display||!b&&v===o.image_display,t=b===g(o.image_file)||!b&&v===g(o.image_file);if(e&&o.image_file){let e=g(o.image_file);if(e&&e!==b){f(e),h(!1);return}}if((e||t)&&o.image){let e=g(o.image);if(e&&e!==b&&e!==v){f(e),h(!1);return}}h(!0)}})})]}):(0,l.jsxs)("div",{className:"relative aspect-[4/3] flex items-center justify-center rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200",children:[j.length>0&&(0,l.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:j.map((e,t)=>(0,l.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,l.jsx)("span",{className:"text-xs font-medium text-slate-400",children:"Aucune image"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:o.name}),o.description&&(0,l.jsx)("p",{className:"mt-2 line-clamp-3 text-xs text-slate-500",children:o.description.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/`/g,"").trim()})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[null===w||isNaN(w)?(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Prix en attente"}):(0,l.jsxs)("p",{className:"text-sm font-semibold text-primary",children:[w.toFixed(3)," MAD"]}),(0,l.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),u?m(o.id):c(o)},className:"rounded-full px-3 py-2 text-xs font-semibold ".concat(u?"bg-secondary text-white":"bg-slate-200 text-slate-700"),type:"button",children:u?"Retirer":"Favori"})]})]})})}},1340:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var l=s(7437),a=s(2265),r=s(2480),i=s(6800),n=s.n(i),d=s(1226),o=s(8357);let c=[{key:"couleur",label:"Couleur"},{key:"taille_ecran",label:"Taille de l'\xe9cran"},{key:"capacite_stockage",label:"Capacit\xe9 de stockage"},{key:"memoire_vive",label:"M\xe9moire vive (RAM)"},{key:"capacite_batterie",label:"Capacit\xe9 de la batterie"},{key:"resolution_ecran",label:"R\xe9solution d'\xe9cran"},{key:"systeme_exploitation",label:"Syst\xe8me d'exploitation"},{key:"nombre_coeurs",label:"Nombre de coeurs de processeurs"},{key:"frequence_processeur",label:"Fr\xe9quence du processeur"},{key:"resolution_camera_avant",label:"R\xe9solution de la cam\xe9ra avant"},{key:"resolution_camera_arriere",label:"R\xe9solution de la cam\xe9ra arri\xe8re"},{key:"carte_sim",label:"Carte SIM"}];function m(e){let{availableBrands:t,availableSpecs:s,filters:a,onChange:i}=e,m=e=>{let{name:t,value:s}=e.target,l=s?Number(s):void 0;i({...a,[t]:Number.isFinite(l)?l:void 0})},x=e=>{let t=a.brands.includes(e);i({...a,brands:t?a.brands.filter(t=>t!==e):[...a.brands,e]})},u=(e,t)=>{let s=a.specs[e]||[],l=s.includes(t);i({...a,specs:{...a.specs,[e]:l?s.filter(e=>e!==t):[...s,t]}})},p=void 0!==a.minPrice||void 0!==a.maxPrice||a.brands.length>0||Object.values(a.specs||{}).some(e=>e.length>0);return(0,l.jsxs)("aside",{className:"space-y-4 sm:space-y-6 rounded-xl sm:rounded-3xl border border-slate-200 bg-white p-4 sm:p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-800",children:"Filtres"}),p&&(0,l.jsx)("button",{onClick:()=>{i({minPrice:void 0,maxPrice:void 0,brands:[],specs:{},ordering:a.ordering})},className:"text-xs sm:text-sm font-medium text-primary hover:text-primary/80 transition-colors",type:"button",children:"R\xe9initialiser"})]}),(0,l.jsx)(r.p,{defaultOpen:!0,children:e=>{var t,s;let{open:i}=e;return(0,l.jsxs)("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200",children:[(0,l.jsxs)(r.p.Button,{className:"flex w-full items-center justify-between px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm font-semibold text-slate-700",children:["Prix",i?(0,l.jsx)(d.Z,{className:"h-4 w-4"}):(0,l.jsx)(o.Z,{className:"h-4 w-4"})]}),(0,l.jsx)(r.p.Panel,{className:"px-3 sm:px-4 pb-3 sm:pb-4",children:(0,l.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"minPrice",className:"text-xs font-medium text-slate-600",children:"Minimum"}),(0,l.jsx)("input",{id:"minPrice",name:"minPrice",type:"number",inputMode:"numeric",className:"mt-1 w-full rounded-lg sm:rounded-xl border border-slate-200 px-3 py-2 text-sm",value:null!==(t=a.minPrice)&&void 0!==t?t:"",onChange:m,placeholder:"0"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"maxPrice",className:"text-xs font-medium text-slate-600",children:"Maximum"}),(0,l.jsx)("input",{id:"maxPrice",name:"maxPrice",type:"number",inputMode:"numeric",className:"mt-1 w-full rounded-lg sm:rounded-xl border border-slate-200 px-3 py-2 text-sm",value:null!==(s=a.maxPrice)&&void 0!==s?s:"",onChange:m,placeholder:"50000"})]})]})})]})}}),(0,l.jsx)(r.p,{defaultOpen:!0,children:e=>{let{open:s}=e;return(0,l.jsxs)("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200",children:[(0,l.jsxs)(r.p.Button,{className:"flex w-full items-center justify-between px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm font-semibold text-slate-700 hover:bg-slate-50 transition-colors",children:[(0,l.jsx)("span",{children:"Marque"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[a.brands.length>0&&(0,l.jsx)("span",{className:"rounded-full bg-primary text-white text-xs px-2 py-0.5",children:a.brands.length}),s?(0,l.jsx)(d.Z,{className:"h-4 w-4"}):(0,l.jsx)(o.Z,{className:"h-4 w-4"})]})]}),(0,l.jsx)(r.p.Panel,{className:"px-3 sm:px-4 pb-3 sm:pb-4",children:t.length>0?(0,l.jsx)("div",{className:"space-y-2 pt-2 max-h-64 overflow-y-auto",children:t.map(e=>{let t=a.brands.includes(e);return(0,l.jsxs)("button",{onClick:()=>x(e),className:n()("flex w-full items-center justify-between rounded-lg sm:rounded-xl border px-3 py-2 text-left text-sm transition-all",t?"border-primary bg-primary/10 text-primary font-medium":"border-slate-200 text-slate-600 hover:border-primary/50 hover:bg-primary/5"),type:"button",children:[(0,l.jsx)("span",{children:e}),t&&(0,l.jsx)("svg",{className:"h-4 w-4 text-primary",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},e)})}):(0,l.jsx)("p",{className:"pt-2 text-xs sm:text-sm text-slate-500",children:"Aucune marque disponible"})})]})}}),c.map(e=>{let t=s[e.key]||[];return(0,l.jsx)(r.p,{children:s=>{let{open:i}=s;return(0,l.jsxs)("div",{className:"rounded-xl sm:rounded-2xl border border-slate-200",children:[(0,l.jsxs)(r.p.Button,{className:"flex w-full items-center justify-between px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm font-semibold text-slate-700 hover:bg-slate-50 transition-colors",children:[(0,l.jsx)("span",{children:e.label}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(a.specs[e.key]||[]).length>0&&(0,l.jsx)("span",{className:"rounded-full bg-primary text-white text-xs px-2 py-0.5",children:(a.specs[e.key]||[]).length}),i?(0,l.jsx)(d.Z,{className:"h-4 w-4"}):(0,l.jsx)(o.Z,{className:"h-4 w-4"})]})]}),(0,l.jsx)(r.p.Panel,{className:"px-3 sm:px-4 pb-3 sm:pb-4",children:t.length>0?(0,l.jsx)("div",{className:"space-y-2 pt-2 max-h-64 overflow-y-auto",children:t.map(t=>{let s=(a.specs[e.key]||[]).includes(t);return(0,l.jsxs)("button",{onClick:()=>u(e.key,t),className:n()("flex w-full items-center justify-between rounded-lg sm:rounded-xl border px-3 py-2 text-left text-sm transition-all",s?"border-primary bg-primary/10 text-primary font-medium":"border-slate-200 text-slate-600 hover:border-primary/50 hover:bg-primary/5"),type:"button",children:[(0,l.jsx)("span",{children:t}),s&&(0,l.jsx)("svg",{className:"h-4 w-4 text-primary",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},t)})}):(0,l.jsx)("p",{className:"pt-2 text-xs sm:text-sm text-slate-500",children:"Aucune valeur disponible"})})]})}},e.key)})]})}var x=s(6847),u=s(9988),p=s(4573),h=s(1961);let b={minPrice:void 0,maxPrice:void 0,brands:[],specs:{},ordering:"lowest_price"};function f(e){let{title:t,endpoint:s,query:r}=e,[i,n]=(0,a.useState)(b),[d,o]=(0,a.useState)([]),[c,f]=(0,a.useState)([]),[g,v]=(0,a.useState)({}),[j,y]=(0,a.useState)(1),[w,N]=(0,a.useState)(0),[_,P]=(0,a.useState)(1),[A,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),E=(0,a.useMemo)(()=>JSON.stringify(null!=r?r:{}),[r]),B=(0,a.useMemo)(()=>{var e;let t={page:j,ordering:null!==(e=i.ordering)&&void 0!==e?e:"lowest_price"};return i.minPrice&&(t.price_min=i.minPrice),i.maxPrice&&(t.price_max=i.maxPrice),i.brands.length>0&&(t.brand=i.brands.join(",")),Object.entries(i.specs||{}).forEach(e=>{let[s,l]=e;l.length>0&&(t["spec_".concat(s)]=l.join(","))}),Object.assign(t,E?JSON.parse(E):{}),t},[i,j,E]);(0,a.useEffect)(()=>{(async function(){k(!0);try{let e=await u.Z.get(s,{params:B});if(o(e.data.results.map(e=>{var t;return{...e,lowestPrice:null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price}})),N(e.data.count),P(e.data.total_pages||1),e.headers["x-available-brands"])f(e.headers["x-available-brands"].split(","));else{let t=Array.from(new Set(e.data.results.map(e=>e.brand).filter(e=>!!e)));f(t)}let t={};e.data.results.forEach(e=>{let s=e.specs;s&&Object.entries(s).forEach(e=>{let[s,l]=e;t[s]||(t[s]=new Set);let a=String(l);a&&"null"!==a&&"undefined"!==a&&t[s].add(a)})});let l={};Object.entries(t).forEach(e=>{let[t,s]=e;l[t]=Array.from(s).sort()}),v(l)}catch(e){console.warn("Failed to load products list",e)}finally{k(!1)}})()},[s,B]),(0,a.useEffect)(()=>{y(1)},[i,E]),(0,a.useEffect)(()=>(C?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[C]);let R=void 0!==i.minPrice||void 0!==i.maxPrice||i.brands.length>0||Object.values(i.specs||{}).some(e=>e.length>0);return(0,l.jsxs)("div",{className:"flex flex-col gap-8 lg:flex-row",children:[(0,l.jsx)("div",{className:"hidden lg:block lg:w-72",children:(0,l.jsx)(m,{availableBrands:c,availableSpecs:g,filters:i,onChange:n})}),C&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>S(!1)}),(0,l.jsxs)("div",{className:"fixed left-0 top-0 h-full w-full max-w-sm bg-white z-50 shadow-2xl transform transition-transform duration-300 ease-in-out lg:hidden overflow-y-auto",children:[(0,l.jsxs)("div",{className:"sticky top-0 bg-white border-b border-slate-200 p-4 flex items-center justify-between z-10",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-800",children:"Filtres"}),(0,l.jsx)("button",{onClick:()=>S(!1),className:"flex items-center justify-center w-10 h-10 rounded-lg text-slate-600 hover:bg-slate-100 transition-colors","aria-label":"Fermer les filtres",type:"button",children:(0,l.jsx)(p.Z,{className:"h-6 w-6"})})]}),(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)(m,{availableBrands:c,availableSpecs:g,filters:i,onChange:n})})]})]}),(0,l.jsxs)("div",{className:"flex-1 space-y-6",children:[(0,l.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("button",{onClick:()=>S(!0),className:"lg:hidden flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors shadow-sm",type:"button",children:[(0,l.jsx)(h.Z,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:"Filtres"}),R&&(0,l.jsx)("span",{className:"rounded-full bg-primary text-white text-xs px-2 py-0.5",children:[void 0!==i.minPrice?1:0,void 0!==i.maxPrice?1:0,i.brands.length,...Object.values(i.specs||{}).map(e=>e.length)].reduce((e,t)=>e+t,0)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-slate-900",children:t}),(0,l.jsxs)("p",{className:"text-sm text-slate-500",children:[w," produits trouv\xe9s"]})]})]}),(0,l.jsxs)("select",{value:B.ordering,onChange:e=>n(t=>({...t,ordering:e.target.value})),className:"rounded-full border border-slate-200 px-4 py-2 text-sm bg-white",children:[(0,l.jsx)("option",{value:"lowest_price",children:"Prix croissant"}),(0,l.jsx)("option",{value:"-lowest_price",children:"Prix d\xe9croissant"}),(0,l.jsx)("option",{value:"-id",children:"Nouveaut\xe9s"})]})]}),A?(0,l.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,l.jsx)("div",{className:"h-60 animate-pulse rounded-3xl bg-gradient-to-br from-slate-100 to-slate-200"},t))}):d.length>0?(0,l.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:d.map(e=>(0,l.jsx)(x.Z,{product:e},e.id))}):(0,l.jsx)("p",{className:"rounded-3xl border border-dashed border-slate-200 bg-white p-10 text-center text-sm text-slate-500",children:"Aucun produit ne correspond \xe0 votre recherche. Ajustez les filtres pour d\xe9couvrir d'autres r\xe9sultats."}),(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-3xl border border-slate-200 bg-white px-4 py-3",children:[(0,l.jsx)("button",{type:"button",className:"rounded-full px-4 py-2 text-sm font-semibold text-primary disabled:text-slate-400",onClick:()=>y(e=>Math.max(1,e-1)),disabled:1===j,children:"Pr\xe9c\xe9dent"}),(0,l.jsxs)("span",{className:"text-sm text-slate-500",children:["Page ",j," sur ",_]}),(0,l.jsx)("button",{type:"button",className:"rounded-full px-4 py-2 text-sm font-semibold text-primary disabled:text-slate-400",onClick:()=>y(e=>Math.min(_,e+1)),disabled:j>=_,children:"Suivant"})]})]})]})}},8618:function(e,t,s){s.d(t,{c:function(){return n},r:function(){return d}});var l=s(7437),a=s(2265);let r=(0,a.createContext)(void 0),i="primini_favorites";function n(e){let{children:t}=e,[s,n]=(0,a.useState)([]);(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem(i);e&&n(JSON.parse(e))}catch(e){console.warn("Failed to restore favorites",e)}},[]),(0,a.useEffect)(()=>{window.localStorage.setItem(i,JSON.stringify(s))},[s]);let d=(0,a.useCallback)(e=>{n(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),o=(0,a.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[]),c=(0,a.useCallback)(e=>s.some(t=>t.id===e),[s]),m=(0,a.useMemo)(()=>({favorites:s,addFavorite:d,removeFavorite:o,isFavorite:c}),[d,s,c,o]);return(0,l.jsx)(r.Provider,{value:m,children:t})}function d(){let e=(0,a.useContext)(r);if(!e)throw Error("useFavorites must be used within FavoritesProvider");return e}},9988:function(e,t,s){var l,a=s(8472),r=s(357);let i=a.Z.create({baseURL:null!==(l=r.env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==l?l:"http://localhost:8000/api",withCredentials:!1});t.Z=i}}]);