"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1779],{1779:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var r=s(7437),o=s(2265),a=s(7138),i=s(6648),c=s(6463),n=s(9343),l=s(1014),d=s(546),u=s(9988);let m=d.Ryn({otp_code:d.Z_8().min(6,"Le code doit contenir 6 chiffres").max(6,"Le code doit contenir 6 chiffres").regex(/^\d+$/,"Le code doit contenir uniquement des chiffres")});function f(){let e=(0,c.useRouter)(),t=(0,c.useSearchParams)(),s=(null==t?void 0:t.get("email"))||"",[d,f]=(0,o.useState)(null),[h,x]=(0,o.useState)(null),{register:p,handleSubmit:v,formState:{errors:g,isSubmitting:y}}=(0,n.cI)({resolver:(0,l.F)(m)});(0,o.useEffect)(()=>{h&&e.push("/forgot-password/reset?token=".concat(encodeURIComponent(h)))},[h,e]);let j=async e=>{if(f(null),!s){f("Email manquant. Veuillez recommencer le processus.");return}try{let t=await u.Z.post("/auth/password/reset/verify/",{email:s,otp_code:e.otp_code});t.data.reset_token&&x(t.data.reset_token)}catch(e){var t;if(console.warn("Failed to verify OTP",e),null===(t=e.response)||void 0===t?void 0:t.data){let t=e.response.data;"string"==typeof t?f(t):t.error?f(t.error):t.otp_code?f(Array.isArray(t.otp_code)?t.otp_code[0]:t.otp_code):t.non_field_errors?f(Array.isArray(t.non_field_errors)?t.non_field_errors[0]:t.non_field_errors):f("Code de v\xe9rification invalide. Veuillez r\xe9essayer.")}else f("Une erreur est survenue. Veuillez r\xe9essayer.")}};return s?(0,r.jsxs)("div",{className:"grid min-h-svh lg:grid-cols-2",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 bg-primary p-4 md:p-6",children:[(0,r.jsx)("div",{className:"flex justify-center gap-2 md:justify-start",children:(0,r.jsx)(a.default,{href:"/",className:"flex items-center gap-2 font-medium",children:(0,r.jsx)(i.default,{src:"/images/avito-colors.jpeg",alt:"Avita",width:120,height:40,className:"h-8 w-auto object-contain",priority:!0})})}),(0,r.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,r.jsxs)("div",{className:"w-full max-w-md space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-white",children:"V\xe9rification du code"}),(0,r.jsxs)("p",{className:"text-sm text-white/80",children:["Entrez le code \xe0 6 chiffres envoy\xe9 \xe0 ",(0,r.jsx)("span",{className:"font-medium",children:s})]})]}),(0,r.jsxs)("form",{onSubmit:v(j),className:"space-y-4",children:[d&&(0,r.jsx)("div",{className:"rounded-md bg-red-500/20 border border-red-400/50 p-3 text-sm text-red-100",children:d}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-white",htmlFor:"otp_code",children:"Code de v\xe9rification *"}),(0,r.jsx)("input",{id:"otp_code",type:"text",maxLength:6,...p("otp_code"),className:"w-full rounded-lg border border-white/20 bg-white/10 backdrop-blur-sm px-4 py-2.5 text-sm text-white placeholder-white/60 focus:border-white/40 focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 text-center text-2xl tracking-widest ".concat(g.otp_code?"border-red-400":""),placeholder:"000000",autoComplete:"one-time-code"}),g.otp_code&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-300",children:g.otp_code.message})]}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded-lg bg-secondary px-4 py-2.5 text-sm font-semibold text-white hover:bg-secondary/90 disabled:opacity-60 disabled:cursor-not-allowed transition-colors shadow-lg",disabled:y,children:y?"V\xe9rification...":"V\xe9rifier le code"}),(0,r.jsx)("div",{className:"text-center text-sm",children:(0,r.jsx)(a.default,{href:"/forgot-password?email=".concat(encodeURIComponent(s)),className:"text-white/80 hover:text-white transition-colors hover:underline",children:"Renvoyer le code"})})]})]})})]}),(0,r.jsx)("div",{className:"bg-muted relative hidden lg:block",children:(0,r.jsx)(i.default,{src:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80",alt:"Cover",fill:!0,className:"object-cover",priority:!0})})]}):(0,r.jsx)("div",{className:"grid min-h-svh lg:grid-cols-2",children:(0,r.jsx)("div",{className:"flex flex-col gap-4 bg-primary p-4 md:p-6",children:(0,r.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,r.jsxs)("div",{className:"w-full max-w-md space-y-4 text-center",children:[(0,r.jsx)("p",{className:"text-white",children:"Email manquant. Veuillez recommencer le processus."}),(0,r.jsx)(a.default,{href:"/forgot-password",className:"text-secondary hover:underline",children:"Retour"})]})})})})}},9988:function(e,t,s){let r=s(8472).Z.create({baseURL:"http://api.azyo6271.odns.fr/api",withCredentials:!1});t.Z=r},6463:function(e,t,s){var r=s(1169);s.o(r,"notFound")&&s.d(t,{notFound:function(){return r.notFound}}),s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}}]);