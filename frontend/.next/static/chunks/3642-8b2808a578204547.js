"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3642],{7977:function(e,t,a){a.d(t,{Z:function(){return d}});var n=a(7437),r=a(2265),i=a(1877),s=a(6648),o=a(7138),l=a(6359);function c(e){return"object"==typeof e&&null!==e&&"ad_type"in e}function d(e){let{slot:t,format:a="auto",style:d={display:"block"},className:u=""}=e,[p,f]=(0,r.useState)(null),[g,h]=(0,r.useState)(void 0),[m,_]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{(async function(){try{let e=await (0,l.FD)();f(e);let a=e[t];h(a)}catch(e){console.warn("Failed to load AdSense config",e),f({enabled:!1,publisher_id:""})}})()},[t]),(0,r.useEffect)(()=>{(null==p?void 0:p.enabled)&&g&&_(!1)},[t,g]),(0,r.useEffect)(()=>{if((null==p?void 0:p.enabled)&&g&&!m){if(c(g)&&"adsense"===g.ad_type){if(p.publisher_id&&g.adsense_id)try{(window.adsbygoogle=window.adsbygoogle||[]).push({}),_(!0)}catch(e){console.error("AdSense error:",e)}}else if("string"==typeof g&&g&&p.publisher_id)try{(window.adsbygoogle=window.adsbygoogle||[]).push({}),_(!0)}catch(e){console.error("AdSense error:",e)}}},[p,g,m]),!(null==p?void 0:p.enabled)||!g)return null;if(c(g)&&"banner"===g.ad_type){if(!g.banner_image)return null;let e=(0,n.jsx)("div",{className:u,style:d,children:(0,n.jsx)(s.default,{src:g.banner_image,alt:"Advertisement",width:728,height:90,className:"w-full h-auto object-contain",unoptimized:!0})});return g.banner_link?(0,n.jsx)(o.default,{href:g.banner_link,target:"_blank",rel:"noopener noreferrer",className:"block",children:e}):e}let b=c(g)?g.adsense_id:"string"==typeof g?g:"";return b&&p.publisher_id?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.default,{async:!0,src:"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=".concat(p.publisher_id),strategy:"afterInteractive",crossOrigin:"anonymous"}),(0,n.jsx)("ins",{className:"adsbygoogle ".concat(u),style:d,"data-ad-client":p.publisher_id,"data-ad-slot":b,"data-ad-format":a,"data-full-width-responsive":"true"})]}):null}},6847:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(7437),r=a(6648),i=a(7138),s=a(2265),o=a(8618),l=a(357);function c(e){var t,a;let{product:c}=e,{addFavorite:d,removeFavorite:u,isFavorite:p}=(0,o.r)(),f=p(c.id),[g,h]=(0,s.useState)(!1),[m,_]=(0,s.useState)(null),b=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/media/")||e.startsWith("media/")){let t=l.env.NEXT_PUBLIC_API_BASE_URL?l.env.NEXT_PUBLIC_API_BASE_URL.replace("/api",""):"http://localhost:8000",a=e.startsWith("/")?e:"/".concat(e);return"".concat(t).concat(a)}if(!e.startsWith("/")){let t=l.env.NEXT_PUBLIC_API_BASE_URL?l.env.NEXT_PUBLIC_API_BASE_URL.replace("/api",""):"http://localhost:8000";return"".concat(t,"/media/products/").concat(e)}return e},x=(0,s.useMemo)(()=>c.image_display?c.image_display:c.image_file?b(c.image_file):c.image?b(c.image):null,[c.image_display,c.image_file,c.image]),v=(null===(t=c.tags)||void 0===t?void 0:t.slice(0,3))||[],y=null!==(a=c.lowestPrice)&&void 0!==a?a:c.lowest_price,w=null!=y?"string"==typeof y?parseFloat(y):y:null,A=m||x;return(0,n.jsx)(i.default,{href:"/product/".concat(c.slug),className:"block h-full",children:(0,n.jsxs)("article",{className:"flex h-full flex-col justify-between rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[A&&!g?(0,n.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden rounded-2xl bg-white",children:[v.length>0&&(0,n.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:v.map((e,t)=>(0,n.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,n.jsx)("div",{className:"absolute inset-2 sm:inset-3",children:(0,n.jsx)(r.default,{src:A,alt:c.name,fill:!0,className:"object-contain transition-transform duration-300 hover:scale-105",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw",quality:90,priority:!1,loading:"lazy",placeholder:"blur",blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mN8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",onError:()=>{let e=m===c.image_display||!m&&x===c.image_display,t=m===b(c.image_file)||!m&&x===b(c.image_file);if(e&&c.image_file){let e=b(c.image_file);if(e&&e!==m){_(e),h(!1);return}}if((e||t)&&c.image){let e=b(c.image);if(e&&e!==m&&e!==x){_(e),h(!1);return}}h(!0)}})})]}):(0,n.jsxs)("div",{className:"relative aspect-[4/3] flex items-center justify-center rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200",children:[v.length>0&&(0,n.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:v.map((e,t)=>(0,n.jsx)("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},t))}),(0,n.jsx)("span",{className:"text-xs font-medium text-slate-400",children:"Aucune image"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:c.name}),c.description&&(0,n.jsx)("p",{className:"mt-2 line-clamp-3 text-xs text-slate-500",children:c.description.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/`/g,"").trim()})]})]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[null===w||isNaN(w)?(0,n.jsx)("p",{className:"text-sm text-slate-500",children:"Prix en attente"}):(0,n.jsxs)("p",{className:"text-sm font-semibold text-primary",children:[w.toFixed(3)," MAD"]}),(0,n.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),f?u(c.id):d(c)},className:"rounded-full px-3 py-2 text-xs font-semibold ".concat(f?"bg-secondary text-white":"bg-slate-200 text-slate-700"),type:"button",children:f?"Retirer":"Favori"})]})]})})}},8618:function(e,t,a){a.d(t,{c:function(){return o},r:function(){return l}});var n=a(7437),r=a(2265);let i=(0,r.createContext)(void 0),s="primini_favorites";function o(e){let{children:t}=e,[a,o]=(0,r.useState)([]);(0,r.useEffect)(()=>{try{let e=window.localStorage.getItem(s);e&&o(JSON.parse(e))}catch(e){console.warn("Failed to restore favorites",e)}},[]),(0,r.useEffect)(()=>{window.localStorage.setItem(s,JSON.stringify(a))},[a]);let l=(0,r.useCallback)(e=>{o(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),c=(0,r.useCallback)(e=>{o(t=>t.filter(t=>t.id!==e))},[]),d=(0,r.useCallback)(e=>a.some(t=>t.id===e),[a]),u=(0,r.useMemo)(()=>({favorites:a,addFavorite:l,removeFavorite:c,isFavorite:d}),[l,a,d,c]);return(0,n.jsx)(i.Provider,{value:u,children:t})}function l(){let e=(0,r.useContext)(i);if(!e)throw Error("useFavorites must be used within FavoritesProvider");return e}},9988:function(e,t,a){var n,r=a(8472),i=a(357);let s=r.Z.create({baseURL:null!==(n=i.env.NEXT_PUBLIC_API_BASE_URL)&&void 0!==n?n:"http://localhost:8000/api",withCredentials:!1});t.Z=s},1279:function(e,t,a){a.d(t,{QQ:function(){return s},R:function(){return r},n3:function(){return o},tG:function(){return l},z6:function(){return i}});var n=a(9988);async function r(e,t){let a={};(null==t?void 0:t.subcategory)&&(a.subcategory=t.subcategory),(null==t?void 0:t.brand)&&(a.brand=t.brand),(null==t?void 0:t.price_min)!==void 0&&(a.price_min=t.price_min.toString()),(null==t?void 0:t.price_max)!==void 0&&(a.price_max=t.price_max.toString()),(null==t?void 0:t.tags)&&t.tags.length>0&&t.tags.forEach(e=>{a.tags=e}),(null==t?void 0:t.ordering)&&(a.ordering=t.ordering),(null==t?void 0:t.page)&&(a.page=t.page.toString()),(null==t?void 0:t.page_size)&&(a.page_size=t.page_size.toString());let r=(await n.Z.get("/categories/".concat(e,"/products/"),{params:a})).data;return{...r,results:r.results.map(e=>{var t;return{...e,lowestPrice:null!==(t=e.lowestPrice)&&void 0!==t?t:e.lowest_price}})}}async function i(e){let t=await n.Z.get("/categories/".concat(e,"/subcategories/"));return Array.isArray(t.data)?t.data:t.data.results||[]}async function s(e,t){let a={};return e&&(a.page=e.toString()),t&&(a.page_size=t.toString()),(await n.Z.get("/categories/parents/",{params:a})).data}async function o(e){return(await n.Z.get("/categories/".concat(e,"/"))).data}async function l(e){let t={};e&&(t.search=e);let a=await n.Z.get("/categories/",{params:{...t,page_size:"1000"}});return Array.isArray(a.data)?a.data:"results"in a.data&&a.data.results||[]}},75:function(e,t,a){a.d(t,{BB:function(){return o},Dg:function(){return d},EE:function(){return g},b4:function(){return p},ch:function(){return s},ex:function(){return c},g4:function(){return i},h7:function(){return l},kR:function(){return h},pF:function(){return u},t$:function(){return m},zb:function(){return f}});var n=a(9988);function r(e){return e?{Authorization:"Token ".concat(e)}:{}}async function i(e,t){let a=new FormData;return a.append("file",e),(await n.Z.post("/products/upload_csv/",a,{headers:{...r(t),"Content-Type":"multipart/form-data"}})).data}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i={page:t.toString()};return a&&(i.approval_status=a),(await n.Z.get("/products/my_products/",{headers:r(e),params:i})).data}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(await n.Z.get("/products/pending/",{headers:r(e),params:{page:t}})).data}async function l(e,t){return(await n.Z.post("/products/".concat(e,"/approve/"),{action:"approve"},{headers:r(t)})).data}async function c(e,t,a){return(await n.Z.post("/products/".concat(e,"/approve/"),{action:"reject",rejection_reason:t},{headers:r(a)})).data}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s={page:t.toString()};return a&&(s.approval_status=a),i&&(s.search=i),(await n.Z.get("/products/",{headers:r(e),params:s})).data}async function u(){let e=await n.Z.get("/merchants/",{params:{page_size:"1000"}});return Array.isArray(e.data)?e.data:e.data.results||[]}async function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(await n.Z.get("/products/with_description/",{params:{min_length:e,page:t,page_size:a}})).data}async function f(e,t){return(await n.Z.post("/offers/submit/",e,{headers:{Authorization:"Token ".concat(t)}})).data}async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(await n.Z.get("/offers/pending/",{headers:{Authorization:"Token ".concat(e)},params:{page:t}})).data}async function h(e,t){return(await n.Z.post("/offers/".concat(e,"/approve/"),{},{headers:{Authorization:"Token ".concat(t)}})).data}async function m(e,t,a){return(await n.Z.post("/offers/".concat(e,"/reject/"),{rejection_reason:t},{headers:{Authorization:"Token ".concat(a)}})).data}},6359:function(e,t,a){a.d(t,{FD:function(){return r},L_:function(){return s},xf:function(){return i}});var n=a(9988);async function r(){return(await n.Z.get("/settings/adsense_config/")).data}async function i(e,t,a){let r=new FormData;return r.append("file",e),r.append("slot_key",t),(await n.Z.post("/settings/upload_banner_image/",r,{headers:{Authorization:"Token ".concat(a),"Content-Type":"multipart/form-data"}})).data}async function s(e,t){let a={enabled:e.enabled,publisher_id:e.publisher_id};["homepage_top","homepage_middle","homepage_bottom","product_detail_sidebar","product_detail_bottom","category_page_top","search_results_middle"].forEach(t=>{let n=e[t];null==n||""===n?a[t]="":"object"==typeof n&&"ad_type"in n?a[t]=JSON.stringify(n):a[t]=n}),await n.Z.post("/settings/adsense_config/",a,{headers:{Authorization:"Token ".concat(t)}})}}}]);