(()=>{var e={};e.id=3374,e.ids=[3374],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9605:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>c,originalPathname:()=>m,pages:()=>p,routeModule:()=>u,tree:()=>d}),t(6909),t(179),t(5866);var r=t(3191),a=t(8716),i=t(7922),n=t.n(i),o=t(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(s,l);let d=["",{children:["magic-tool",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6909)),"/Users/khairallahmohammed/Documents/primini/frontend/app/magic-tool/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,179)),"/Users/khairallahmohammed/Documents/primini/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],p=["/Users/khairallahmohammed/Documents/primini/frontend/app/magic-tool/page.tsx"],m="/magic-tool/page",c={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/magic-tool/page",pathname:"/magic-tool",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2156:(e,s,t)=>{Promise.resolve().then(t.bind(t,1284)),Promise.resolve().then(t.bind(t,933)),Promise.resolve().then(t.bind(t,6618))},3333:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var r=t(326),a=t(6226),i=t(434),n=t(7577),o=t(2679);function l({product:e}){let{addFavorite:s,removeFavorite:t,isFavorite:l}=(0,o.r)(),d=l(e.id),[p,m]=(0,n.useState)(!1),[c,u]=(0,n.useState)(null),x=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/media/")||e.startsWith("media/")){let s="https://api.azyo6271.odns.fr/api".replace("/api",""),t=e.startsWith("/")?e:`/${e}`;return`${s}${t}`}if(!e.startsWith("/")){let s="https://api.azyo6271.odns.fr/api".replace("/api","");return`${s}/media/products/${e}`}return e},h=(0,n.useMemo)(()=>e.image_display?e.image_display:e.image_file?x(e.image_file):e.image?x(e.image):null,[e.image_display,e.image_file,e.image]),g=e.tags?.slice(0,3)||[],f=e.lowestPrice??e.lowest_price,b=null!=f?"string"==typeof f?parseFloat(f):f:null,_=c||h;return r.jsx(i.default,{href:`/product/${e.slug}`,className:"block h-full",children:(0,r.jsxs)("article",{className:"flex h-full flex-col justify-between rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-lg cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[_&&!p?(0,r.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden rounded-2xl bg-white",children:[g.length>0&&r.jsx("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:g.map((e,s)=>r.jsx("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},s))}),r.jsx("div",{className:"absolute inset-2 sm:inset-3",children:r.jsx(a.default,{src:_,alt:e.name,fill:!0,className:"object-contain transition-transform duration-300 hover:scale-105",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw",quality:90,priority:!1,loading:"lazy",placeholder:"blur",blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mN8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",onError:()=>{let s=c===e.image_display||!c&&h===e.image_display,t=c===x(e.image_file)||!c&&h===x(e.image_file);if(s&&e.image_file){let s=x(e.image_file);if(s&&s!==c){u(s),m(!1);return}}if((s||t)&&e.image){let s=x(e.image);if(s&&s!==c&&s!==h){u(s),m(!1);return}}m(!0)},unoptimized:!0})})]}):(0,r.jsxs)("div",{className:"relative aspect-[4/3] flex items-center justify-center rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200",children:[g.length>0&&r.jsx("div",{className:"absolute top-2 left-2 z-10 flex flex-wrap gap-1.5",children:g.map((e,s)=>r.jsx("span",{className:"px-2 py-0.5 text-[10px] sm:text-xs font-medium bg-white/90 backdrop-blur-sm text-slate-700 rounded-full border border-slate-200 shadow-sm",children:e},s))}),r.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Aucune image"})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:e.name}),e.description&&r.jsx("p",{className:"mt-2 line-clamp-3 text-xs text-slate-500",children:e.description.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/`/g,"").trim()})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[null===b||isNaN(b)?r.jsx("p",{className:"text-sm text-slate-500",children:"Prix en attente"}):(0,r.jsxs)("p",{className:"text-sm font-semibold text-primary",children:[b.toFixed(3)," MAD"]}),r.jsx("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),d?t(e.id):s(e)},className:`rounded-full px-3 py-2 text-xs font-semibold ${d?"bg-secondary text-white":"bg-slate-200 text-slate-700"}`,type:"button",children:d?"Retirer":"Favori"})]})]})})}},1284:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var r=t(326),a=t(7577),i=t(4723),n=t(1214),o=t(1980),l=t(4143),d=t(3333);function p(){let[e,s]=(0,a.useState)([]),[t,p]=(0,a.useState)(!1),[m,c]=(0,a.useState)(),{register:u,handleSubmit:x,formState:{errors:h,isSubmitting:g},reset:f}=(0,i.cI)({resolver:(0,n.F)(l.xj)}),b=async e=>{p(!0),c(void 0);try{let t=await o.Z.post("/products/magic_lookup/",{link:e.url});s((t.data.products??[]).map(e=>({...e,lowestPrice:e.lowestPrice??e.lowest_price}))),c(t.data.message),f()}catch(e){console.warn("Failed to analyse url",e),c("Impossible de r\xe9cup\xe9rer les informations pour ce lien.")}finally{p(!1)}};return(0,r.jsxs)("div",{className:"space-y-10",children:[(0,r.jsxs)("header",{className:"space-y-2",children:[r.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"L'outil magique"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Collez un lien produit pour d\xe9couvrir automatiquement les meilleures offres disponibles."})]}),(0,r.jsxs)("form",{onSubmit:x(b),className:"flex flex-col gap-3 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm md:flex-row",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("input",{type:"url",...u("url"),placeholder:"https://www.example.com/produit",className:`w-full rounded-2xl border border-slate-200 px-4 py-3 text-sm ${h.url?"border-red-500":""}`}),h.url&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.url.message})]}),r.jsx("button",{type:"submit",className:"rounded-full bg-primary px-5 py-3 text-sm font-semibold text-white disabled:opacity-60",disabled:g||t,children:t?"Analyse en cours...":"Comparer"})]}),m&&r.jsx("p",{className:"rounded-2xl bg-slate-100 px-4 py-3 text-sm text-slate-600",children:m}),r.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.map(e=>r.jsx(d.Z,{product:e},e.id))})]})}},4143:(e,s,t)=>{"use strict";t.d(s,{$T:()=>l,Iy:()=>a,cU:()=>o,dm:()=>i,xj:()=>d});var r=t(9969);let a=r.Ryn({name:r.Z_8().min(1,"Le nom du produit est requis").min(3,"Le nom doit contenir au moins 3 caract\xe8res").max(200,"Le nom ne peut pas d\xe9passer 200 caract\xe8res"),description:r.Z_8().min(1,"La description est requise").min(500,"La description doit contenir au moins 500 caract\xe8res").max(5e3,"La description ne peut pas d\xe9passer 5000 caract\xe8res"),brand:r.Z_8().max(120,"La marque ne peut pas d\xe9passer 120 caract\xe8res").optional().or(r.i0J("")),category_id:r.G0j([r.Rxh().positive("Cat\xe9gorie invalide"),r.qnd(),r.S1Z()]).transform(e=>"number"!=typeof e||isNaN(e)?void 0:e).optional(),image:r.Z_8().refine(e=>!e||r.Z_8().url().safeParse(e).success,"URL invalide").optional().or(r.i0J("")),tags:r.IXX(r.Z_8().min(1,"Les tags ne peuvent pas \xeatre vides")).max(20,"Maximum 20 tags autoris\xe9s").optional(),specs:r.IMB(r.Z_8(),r.G0j([r.Z_8(),r.Rxh(),r.O72()])).optional(),release_date:r.Z_8().refine(e=>!e||/^\d{4}-\d{2}-\d{2}$/.test(e),"Format de date invalide (YYYY-MM-DD)").optional().or(r.i0J("")),source_category:r.Z_8().max(150,"La cat\xe9gorie source ne peut pas d\xe9passer 150 caract\xe8res").optional().or(r.i0J(""))}),i=r.Ryn({email:r.Z_8().min(1,"L'adresse email est requise").email("Format d'email invalide"),password:r.Z_8().min(1,"Le mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caract\xe8res")}),n=r.Ryn({username:r.Z_8().min(1,"Le nom d'utilisateur est requis").min(3,"Le nom d'utilisateur doit contenir au moins 3 caract\xe8res").max(150,"Le nom d'utilisateur ne peut pas d\xe9passer 150 caract\xe8res").regex(/^[a-zA-Z0-9_]+$/,"Le nom d'utilisateur ne peut contenir que des lettres, chiffres et underscores"),email:r.Z_8().min(1,"L'adresse email est requise").email("Format d'email invalide"),password1:r.Z_8().min(1,"Le mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caract\xe8res").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Le mot de passe doit contenir au moins une majuscule, une minuscule et un chiffre"),password2:r.Z_8().min(1,"La confirmation du mot de passe est requise"),first_name:r.Z_8().min(1,"Le pr\xe9nom est requis").max(150,"Le pr\xe9nom ne peut pas d\xe9passer 150 caract\xe8res"),last_name:r.Z_8().min(1,"Le nom est requis").max(150,"Le nom ne peut pas d\xe9passer 150 caract\xe8res")}),o=n.extend({enterprise_name:r.Z_8().min(1,"Le nom de l'entreprise est requis").max(200,"Le nom de l'entreprise ne peut pas d\xe9passer 200 caract\xe8res"),address:r.Z_8().min(1,"L'adresse est requise").max(500,"L'adresse ne peut pas d\xe9passer 500 caract\xe8res"),phone_number:r.Z_8().min(1,"Le num\xe9ro de t\xe9l\xe9phone est requis").max(20,"Le num\xe9ro de t\xe9l\xe9phone ne peut pas d\xe9passer 20 caract\xe8res").regex(/^[\d\s\-\+\(\)]+$/,"Le num\xe9ro de t\xe9l\xe9phone contient des caract\xe8res invalides")}).refine(e=>e.password1===e.password2,{message:"Les mots de passe ne correspondent pas",path:["password2"]}),l=n.refine(e=>e.password1===e.password2,{message:"Les mots de passe ne correspondent pas",path:["password2"]});r.Ryn({threshold:r.Z_8().min(1,"Le prix seuil est requis").refine(e=>!isNaN(Number(e))&&Number(e)>0,"Le prix doit \xeatre un nombre positif")});let d=r.Ryn({url:r.Z_8().min(1,"L'URL est requise").url("Format d'URL invalide")});r.Ryn({file:r.PpW(File).refine(e=>e.size<=10485760,"Le fichier ne peut pas d\xe9passer 10MB").refine(e=>e.name.endsWith(".csv"),"Le fichier doit \xeatre un fichier CSV")})},6909:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(9510);let a=(0,t(8318).default)(()=>t.e(6039).then(t.bind(t,6039)),{loadableGenerated:{modules:["app/magic-tool/page.tsx -> ../../components/screens/MagicToolScreen"]},ssr:!1});function i(){return r.jsx(a,{})}}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[9797,5414,7325],()=>t(9605));module.exports=r})();